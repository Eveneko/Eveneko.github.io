<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Firmware Readpaper | Neko Nest</title>
<meta name=keywords content="Firmware,Paper"><meta name=description content="本页面收录和车辆固件在模拟环境下模糊测试相关的论文。(43篇) All Papers(Classification according to Subject) Survey/Review Detecting Vulnerability on IoT Device Firmware: A Survey (2022) {% spoiler more %} 物联网 (IoT) 设备占所有网络连接端点的 30%，引入了漏洞和新颖的攻击，使许多公司成为网络犯罪分子的主要目标。为了应对这种日益增加的威胁面，每个部署物联网设备的组织都需要考虑安全风险，以确"><meta name=author content="Eveneko"><link rel=canonical href=https://eveneko.com/posts/firmware-readpaper/><link crossorigin=anonymous href=/assets/css/stylesheet.3613efbd0b1772781e8f49935e973cae632a7f61471c05b17be155505ccf87b5.css integrity="sha256-NhPvvQsXcngej0mTXpc8rmMqf2FHHAWxe+FVUFzPh7U=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://eveneko.com/images/logo.svg><link rel=icon type=image/png sizes=16x16 href=https://eveneko.com/images/logo.svg><link rel=icon type=image/png sizes=32x32 href=https://eveneko.com/images/logo.svg><link rel=apple-touch-icon href=https://eveneko.com/images/logo.svg><link rel=mask-icon href=https://eveneko.com/images/logo.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Firmware Readpaper"><meta property="og:description" content="本页面收录和车辆固件在模拟环境下模糊测试相关的论文。(43篇) All Papers(Classification according to Subject) Survey/Review Detecting Vulnerability on IoT Device Firmware: A Survey (2022) {% spoiler more %} 物联网 (IoT) 设备占所有网络连接端点的 30%，引入了漏洞和新颖的攻击，使许多公司成为网络犯罪分子的主要目标。为了应对这种日益增加的威胁面，每个部署物联网设备的组织都需要考虑安全风险，以确"><meta property="og:type" content="article"><meta property="og:url" content="https://eveneko.com/posts/firmware-readpaper/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-07-10T17:27:17+08:00"><meta property="article:modified_time" content="2022-07-10T17:27:17+08:00"><meta property="og:site_name" content="Neko Nest"><meta name=twitter:card content="summary"><meta name=twitter:title content="Firmware Readpaper"><meta name=twitter:description content="本页面收录和车辆固件在模拟环境下模糊测试相关的论文。(43篇) All Papers(Classification according to Subject) Survey/Review Detecting Vulnerability on IoT Device Firmware: A Survey (2022) {% spoiler more %} 物联网 (IoT) 设备占所有网络连接端点的 30%，引入了漏洞和新颖的攻击，使许多公司成为网络犯罪分子的主要目标。为了应对这种日益增加的威胁面，每个部署物联网设备的组织都需要考虑安全风险，以确"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://eveneko.com/posts/"},{"@type":"ListItem","position":3,"name":"Firmware Readpaper","item":"https://eveneko.com/posts/firmware-readpaper/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Firmware Readpaper","name":"Firmware Readpaper","description":"本页面收录和车辆固件在模拟环境下模糊测试相关的论文。(43篇) All Papers(Classification according to Subject) Survey/Review Detecting Vulnerability on IoT Device Firmware: A Survey (2022) {% spoiler more %} 物联网 (IoT) 设备占所有网络连接端点的 30%，引入了漏洞和新颖的攻击，使许多公司成为网络犯罪分子的主要目标。为了应对这种日益增加的威胁面，每个部署物联网设备的组织都需要考虑安全风险，以确","keywords":["Firmware","Paper"],"articleBody":"本页面收录和车辆固件在模拟环境下模糊测试相关的论文。(43篇)\nAll Papers(Classification according to Subject) Survey/Review Detecting Vulnerability on IoT Device Firmware: A Survey (2022) {% spoiler more %} 物联网 (IoT) 设备占所有网络连接端点的 30%，引入了漏洞和新颖的攻击，使许多公司成为网络犯罪分子的主要目标。为了应对这种日益增加的威胁面，每个部署物联网设备的组织都需要考虑安全风险，以确保这些设备的安全和可信。在所有安全风险解决方案中，固件安全分析对于修复软件错误、修补漏洞或添加新的安全功能以保护易受攻击设备的用户至关重要。然而，由于执行环境的多样性和固件的密切来源，固件安全分析从来都不是一件容易的事。这两个不同的功能使解压固件样本以进行详细分析的操作变得复杂。它们还使得创建视觉环境来模拟设备固件的运行变得困难。尽管研究人员在过去十年中开发了许多新方法来克服各种挑战，但在实践中，关键障碍阻碍了固件安全分析。因此，本次调查旨在系统地回顾和分析研究挑战及其解决方案，同时考虑广度和深度。具体来说，根据分析的角度，介绍了对物联网设备进行安全分析的各种方法，并将其分为四类。详细讨论了每个类别中的挑战，随后提出了潜在的解决方案。然后，我们讨论了这些解决方案的缺陷，并为该研究领域提供了未来的方向。包括软件开发人员、网络安全研究人员和软件安全工程师在内的广大读者可以利用本调查来更好地了解固件安全分析。 {% endspoiler %}\nFuzzing: A Survey for Roadmap (2022) {% spoiler more %} G.O.S.S.I.P 学术论文推荐 2022-02-28 Fuzzing: A Survey for Roadmap\n模糊测试(fuzzing)是近年来在安全法律检测领域兴起的一种方法。它生成大量的测试用例，并监视缺陷的执行。Fuzzing已经在各种应用程序中发现了数千个bug和漏洞。虽然有效，但缺乏对模糊所面临的空白的系统分析。模糊化作为一种缺陷检测技术，需要缩小整个输入空间与缺陷空间之间的差距。不限制生成的输入，输入空间是无限大的。然而，缺陷在应用程序中是稀疏的，这表明缺陷空间比整个输入空间小得多。此外，由于fuzzing会产生大量的测试用例来反复检查目标，因此需要fuzzing以自动的方式执行。由于应用程序的复杂性和缺陷，对不同应用程序的自动化执行具有挑战性。在本文中，我们从广度和深度两方面系统地回顾和分析了这些差距及其解决方案。这个调查可以成为初学者和高级开发人员更好地理解模糊的路线图。 {% endspoiler %}\nChallenges in Firmware Re-Hosting, Emulation, and Analysis (2021) {% spoiler more %} {% endspoiler %}\nA Review of Fuzzing Techniques (2021) {% spoiler more %} {% post_link ‘paper-vfsf-1’ ‘Note’ %} 模糊测试是一种安全测试技术,主要用于检测安全漏洞,近几年模糊测试技术经历了快速发展,因此有必要对相关成果进行总结和分析．通过搜集和分析网络与系统安全国际四大顶级安全会议(IEEES\u0026P,USENIXSecurity,CCS,NDSS)中相关的文章,总结出模糊测试的基本工作流程,包括:预处理、输入数据构造、输入选择、评估、结果分析这５个环节,针对每个环节中面临的任务以及挑战,结合相应的研究成果进行分析和总结,其中重点分析以 American Fuzzy Lop 工具及其改进成果为代表的,基于覆盖率引导的模糊测试方法．模糊测试技术在不同领域中使用时,面对着巨大的差异性,通过对相应文献进行整理和分析,总结出特定领域中使用模糊测试的独特需求以及相应的解决方法,重点关注物联网领域,以及内核安全领域．近些年反模糊测试技术以及机器学习技术的进步,给模糊测技术的发展带来了挑战和机遇,这些机遇和挑战为下一步的研究提供了方向参考． {% endspoiler %}\nIoT Bugs and Development Challenges (2021) {% spoiler more %} 物联网系统迅速应用于各个领域，从嵌入式系统到智能家居。尽管物联网的采用和普及程度越来越高，但目前还没有深入的研究来从从业者的角度了解物联网发展面临的挑战。我们通过大规模的实证调查，首次系统地研究了物联网开发人员在实践中面临的bug和挑战。我们从91个具有代表性的物联网项目存储库中收集了5565个bug报告，并根据观察到的故障、根本原因和故障组件的位置对323个随机样本进行了分类。此外，我们对物联网专家进行了9次访谈，以揭示物联网bug的更多细节，并深入了解物联网开发人员面临的挑战。最后，我们调查了194名IoT开发人员，以验证我们的发现并获得进一步的见解。基于我们的研究结果，我们提出了物联网系统的第一个bug分类。我们强调了常见的bug类别及其根本原因、它们之间的相关性，以及物联网开发人员面临的常见陷阱和挑战。我们为需要关注的物联网领域推荐未来的发展方向。索引术语-物联网，软件工程，挖掘软件库，实证研究。 {% endspoiler %}\n嵌入式设备固件安全分析技术研究 (2021) {% spoiler more %} {% post_link ‘paper-vfsf-5’ ‘Note’ %}\n随着嵌入式设备的种类和数量的增加，设备之间日益增长的互联互通、制造商对安全的忽视、设备固件更 新不及时或难以更新等，使得嵌入式设备的安全受到了严峻的考验，越来越多的设备漏洞被披露．但由于嵌入式设 备种类繁多、专用性强、源码或设计文档往往不公开、运行环境受限等诸多因素的影响，通用漏洞挖掘技术无法直 接适配．近年来，国内外安全专家和学者针对嵌入式设备及其固件的安全分析和测评技术提出了很多切实可行的 解决方案，但缺乏详细和全面介绍最新安全研究成果的论文，使得安全分析人员难以系统地了解嵌入式设备及其 固件安全分析技术的研究进展．本文围绕着当前嵌入式设备固件面临的安全风险，分析和总结了国内外最新的研 究成果，并对相关安全技术进行了综合分析和评估．首先对嵌入式设备及其固件的表现形式、分类及获取方法、面 临的安全攻击层面以及自动化解析情况进行了深入研究．然后，对嵌入式设备固件安全分析技术进行了细化分析，从静态分析、符号执行、二进制漏洞关联、动态分析平台和模糊测试等五个方面进行了详细分析和横向评估．最后 对未来的研究方向进行了展望。 {% endspoiler %}\nFirmware Fuzzing: The State of the Art (2020) {% spoiler more %} {% post_link ‘paper-vfsf-4’ ‘Note’ %} 背景:固件是物联网设备的使能软件，其软件漏洞是物联网设备被利用的主要原因之一。由于物联网设备资源有限，部署复杂的运行时保护技术是不切实际的。在不安全的网络环境下，当固件被利用时，可能会导致拒绝服务、信息泄露、特权提升，甚至危及生命。因此，利用模糊技术进行固件漏洞检测已成为保障物联网设备安全的关键，也成为学术界和工业界研究的热点。随着现有物联网设备的快速增长、固件的规模和复杂性、固件类型的多样性以及固件的缺陷，现有的物联网固件模糊化方法面临挑战。 目的:总结物联网固件模糊化方法的典型类型，分析这些工作的贡献，总结现有模糊化方法的不足。 方法:设计几个研究问题，从研究问题中提取关键词，利用关键词检索相关文献。 结果:根据固件的执行环境，我们将现有的固件模糊化工作分为基于真实设备的模糊化和基于仿真的模糊化，基于仿真的模糊化是未来的主流;我们发现现有模糊化方法主要针对的漏洞类型为内存破坏漏洞;固件模糊比普通软件模糊困难得多。 结论:通过分析不同方法的优缺点，本文为进一步提高模糊化技术的性能提供了指导，并根据本文的研究结果提出了几点建议。 {% endspoiler %}\nFuzzing: State of the Art (2018) {% spoiler more %} 模糊测试(fuzzing)是目前最流行的软件测试技术之一，它通过生成大量的测试输入，可以发现程序中的各种弱点，如软件bug和漏洞。由于其有效性，模糊被认为是一种有价值的bug搜索方法。在这篇论文中，我们提出了模糊化的概述，集中在其一般过程，以及分类，随后详细讨论了关键障碍和一些旨在克服或减轻这些障碍的最先进的技术。我们进一步研究和分类了几种广泛使用的模糊工具。我们的主要目标是让涉众更好地理解模糊，以及在软件测试和安全范围内改进模糊方法的潜在解决方案。为了启发未来的研究，我们还预测了模糊化的一些未来方向。 {% endspoiler %}\nThe Art, Science, and Engineering of Fuzzing: A Survey (2018) {% spoiler more %} 在当今可用的许多软件漏洞发现技术中，模糊分析由于其概念上的简单性、部署的低门槛以及在发现真实软件漏洞方面的大量经验证据而一直非常受欢迎。在较高的层次上，模糊是指重复运行程序的过程，所生成的输入可能在语法或语义上有缺陷。近年来，研究人员和从业人员都投入了大量和多样化的努力来改善模糊化，但这一工作的激增也使人们难以获得关于模糊化的全面和连贯的观点。为了帮助保持和使大量模糊化文献保持连贯性，本文提出了一个统一的、通用的模糊化模型，并对当前模糊化文献进行了分类。我们系统地探索模型模糊器每个阶段的设计决策，通过调查艺术、科学和工程方面的相关文献和创新，使现代模糊器有效。 {% endspoiler %}\nGeneral Fuzzing LibAFL: A Framework to Build Modular and Reusable Fuzzers (2022) {% spoiler more %} G.O.S.S.I.P 阅读推荐 2022-08-24 LibAFL AFL的发布标志着软件安全测试领域的一个重要里程碑，重新激活了fuzzing作为一个主要的研究课题，并激发了大量试图改进和评估fuzzing管道不同方面的研究。许多这样的研究通过AFL代码库分叉来实现他们的技术。虽然这个选择乍一看似乎是合适的，但将多个分叉组合成一个模糊器需要很高的工程开销，这将阻碍该领域的进展，并阻止对不同技术的公平和客观的评估。模糊生态系统的高度碎片化景观也阻止了研究人员结合正交技术，并使最终用户难以采用新的原型解决方案。为了解决这一问题，本文提出了一种模块化、可重用的模糊信号处理框架LibAFL。我们讨论了模糊处理中通常使用的不同组件，并将它们映射到一个可扩展的框架。LibAFL允许研究人员和工程师扩展核心模糊器管道，并为进一步评估共享他们的新组件。作为LibAFL的一部分，我们集成了20多个以前工作的技术，并进行了广泛的实验，以展示我们的框架在结合和评估不同方法方面的好处。我们希望这能帮助阐明当前模糊化的进展，并为未来的比较和可扩展的研究提供一个坚实的基础。 {% endspoiler %}\nFirmware Fuzzing Fuzzware: Using Precise MMIO Modeling for Effective Firmware Fuzzing (2022) {% spoiler more %} 随着嵌入式设备在我们的日常生活中越来越普遍，它们成为对手的一个诱人的目标。尽管它们具有很高的价值和较大的攻击面，但应用自动化测试技术(如模糊)对这类设备并不是很直接。由于在受限的嵌入式设备上对固件进行模糊测试效率低下，最先进的方法反而选择在模拟器中运行固件(通过一个称为重新托管的过程)。然而，现有的方法要么使用粗粒度的硬件行为静态模型，要么需要手工重新托管固件。我们提出了一种轻量级程序分析、重新托管和模糊测试的新组合来解决这些挑战。本文提出了一种软件专用系统FUZZWARE的设计与实现方法，该系统能够以一种可扩展的方式对未修改的单片固件进行模糊测试。通过确定硬件生成的值是如何被固件逻辑实际使用的，FUZZWARE可以自动生成模型，帮助将模糊处理集中在改变重要的输入上，这大大提高了它的效率。我们在包括19个硬件平台和77个固件图像的合成目标和真实目标上评估我们的方法。与最先进的工作相比，FUZZ-WARE实现了高达3.25倍的代码覆盖率，我们的建模方法减少了高达95.5%的输入空间的大小。合成样本包含66个针对各种硬件交互的单元测试，我们发现我们的方法是第一个自动通过所有单元测试的通用重新托管解决方案。FUZZWARE发现了15个全新的bug，包括其他作品之前分析的目标bug;总共分配了12个cve。 {% endspoiler %}\nFIRM-COV: High-Coverage Greybox Fuzzing for IoT Firmware via Optimized Process Emulation (2021) {% spoiler more %} 随着物联网(IoT)的日益普及，相关的安全威胁也随之增加。动态检测物联网设备漏洞的必要性再怎么强调也不为过。在这项工作中，我们提出了FIRM-COV，这是第一个面向物联网固件的高覆盖率灰盒模糊器。FIRMCOV通过针对物联网程序和挖掘真实世界漏洞，利用最新优化的流程模拟。基于经验分析，利用结构化输入、仿真的不准确性和不稳定性以及对代码覆盖率的要求，致力于解决物联网模糊化问题。通过优化现有的仿真技术，FIRM-COV在检测漏洞时始终保持稳定状态，准确率较高。我们还实现字典生成算法，以提供结构化的输入值和协同调度，以实现高覆盖率和吞吐量。我们将FIRM-COV与其他针对8个真实物联网设备的物联网模糊框架进行比较。因此，FIRM-COV实现了最高的覆盖率和吞吐量，发现了最快和最多的1天漏洞，几乎没有误报。它还在24小时内发现了现实物联网设备中的两个0天漏洞。 {% endspoiler %}\nDIANE: Identifying Fuzzing Triggers in Apps to Generate Under-constrained Inputs for IoT Devices (2021) {% spoiler more %} 物联网(IoT)设备已经根植于数十亿人的日常生活中。因此，研究人员已经应用自动bug查找技术来提高整体安全性。然而，由于提取和模拟自定义固件的困难，黑盒模糊往往是唯一可行的分析选择。不幸的是，这种解决方案大多会产生无效输入，这些输入会被目标物联网设备迅速丢弃，并且无法穿透其代码。另一种建议的方法是利用配套应用程序(即通常用于控制物联网设备的移动应用程序)来生成结构良好的模糊输入。不幸的是，现有的解决方案产生的模糊输入受到应用程序端验证代码的限制，从而大大限制了发现的漏洞的范围。在本文中，我们提出了一种新的方法来克服这些限制。我们的关键观察是，在配套的应用程序中存在可用于生成最佳(即有效但不受约束)模糊输入的函数。这样的函数，我们称之为模糊触发器，在任何数据转换函数(例如，网络序列化)之前执行，但在输入验证代码之后执行。因此，它们生成的输入不受应用端消毒代码的约束，同时，也不会因其格式无效而被分析的物联网设备丢弃。我们设计和开发了一款结合静态和动态分析的工具，在Android配套应用中寻找模糊触发点，然后使用它们自动模糊物联网设备。我们使用DIANE分析了11个流行的物联网设备，并识别了11个bug，其中9个是零天。我们的结果还表明，如果不使用模糊触发，就不可能为许多设备生成错误触发输入。 {% endspoiler %}\nFIRMNANO: Toward IoT Firmware Fuzzing Through Augmented Virtual Execution (2020) {% spoiler more %} 考虑到物联网设备的部署越来越广泛，这些设备的固件的安全分析是极其重要的。然而，现在大量的设备都存在漏洞，攻击者可以利用这些漏洞远程控制物联网设备。在本文中，我们展示了FIRMNANO，一个以微控制器为核心的fiot设备固件模糊化框架。FIRMNANO基于增强的虚拟执行，解决了微控制器固件仿真的三个关键问题:(1)MMIO区域访问(2)中断触发(3)DMA支持。在此基础上，对固件进行了基于代码覆盖的模糊测试。我们的评估结果表明，FIRMNANO可以正确地执行固件，并可用于真实的固件漏洞挖掘。 {% endspoiler %}\nEM-Fuzz: Augmented Firmware Fuzzing via Memory Checking (2020) {% spoiler more %} 在新兴的应用场景中，嵌入式系统的互联程度越来越高。这些应用程序中的许多都对安全至关重要，因此，确保系统免受恶意攻击是非常重要的。这项工作的目的是检测嵌入式固件中的漏洞，这些漏洞可能被对手利用来破坏功能的正确性，这是具有挑战性的，特别是由于缺乏源代码。特别地，我们提出EM-Fuzz，这是一种固件漏洞检测技术，它将fuzzing与实时内存检查紧密地集成在一起。基于内存检测的固件模糊化不仅可以通过传统的分支覆盖来引导生成高质量的种子来探测难以到达的区域，还可以通过记录的内存敏感操作来连续地锻炼容易被攻击的敏感区域。更重要的是，该检测集成了实时内存检查器来暴露内存漏洞，这是现有的没有源代码的模糊器所不能很好地支持的。在几个真实世界的嵌入式固件(如OpenSSL)上的实验表明，EM-Fuzz显著提高了最先进的模糊工具(如AFL和AFLFast)的性能，覆盖率分别提高了93.98%和46.89%。此外，EM-Fuzz总共暴露了23个漏洞，每个漏洞平均耗时约7小时。AFL和AFLFast总共发现了10个漏洞，平均每个漏洞花费的时间分别为13小时和10小时。在这23个漏洞中，有16个以前是未知的，并且已经报告给了上游产品供应商，其中7个在美国国家漏洞数据库中被分配了唯一的CVE标识符。 {% endspoiler %}\nFw-fuzz: A code coverage-guided fuzzing framework for network protocols on firmware (2020) {% spoiler more %} 模糊化是一种利用可变生成输入检测软件漏洞的有效方法。然而，在物联网设备的固件上模糊网络协议受到测试用例生成、跨架构检测和故障检测效率低的限制。在本文中，我们提出了Fw-fuzz，这是一个覆盖引导的跨平台框架，用于模糊在嵌入式体系结构上的固件上下文中运行的网络服务，它可以通过内省程序运行时信息和使用遗传算法模型生成更多有价值的测试用例。具体地说，我们在Fw-fuzz中提出了新颖的动态工具来收集固件程序的运行状态。Fw-fuzz采用一种遗传算法模型指导代码覆盖率高的输入生成。我们全面实现了Fw-fuzz的原型系统，并对MIPS、ARM、PPC等多种架构的网络服务程序进行了评估。通过与协议模糊器Boofuzz和Peach在边缘覆盖指标方面的比较，我们的原型系统分别获得了33.7%和38.4%的平均增长率。我们进一步验证了6个已知的漏洞，并利用Fw-fuzz发现了5个0天漏洞，证明了我们的框架的有效性和实用性。我们系统的开销表示为内存增长的额外5%。 {% endspoiler %}\nFIRMCORN: Vulnerability-Oriented Fuzzing of IoT Firmware via Optimized Virtual Execution (2020) {% spoiler more %} 物联网(IoT)的安全形势尤为严峻，大量物联网设备容易出现漏洞。在本研究中，我们提出了第一个面向漏洞的物联网固件模糊器FIRMCORN。基于优化虚拟执行的新技术，FIRMCORN重点研究了物联网固件模糊化的三个典型问题:(1)模糊化需要高吞吐量;(2)仿真与真实设备相比不准确;(3)缺乏硬件导致的仿真不稳定。在这里，我们优化了虚拟执行的初始环境和执行过程，以实现更快、更准确、更稳定的模糊测试。为提高fircorn漏洞挖掘的效率，根据物联网固件的特点，设计了一种漏洞代码搜索算法，获取模糊化入口点;此外，这种面向漏洞的模糊处理应用于物联网设备固件。我们的评估结果表明，与传统虚拟执行相比，fircorn使用的优化虚拟执行可以显著提高吞吐量、准确性和稳定性。FIRMCORN只运行2小时，就能在一台机器上挖掘出两个0天的漏洞。因此，与目前最先进的物联网固件模糊化框架相比，FIRMCORN可以更有效地挖掘现实设备中的漏洞。 {% endspoiler %}\nFirmFuzz: Automated IoT Firmware Introspection and Analysis (2019) {% spoiler more %} 虽然物联网设备的数量以令人振奋的速度增长，但其安全性却停滞不前。在所有供应商之间强制执行安全编码标准是不可行的。测试单个设备可以让分析师评估其部署后的安全性。然后可以向供应商披露任何发现的漏洞，以帮助他们保护其产品。为了提高效率，理想情况下应该自动查找漏洞，而且为了提高可伸缩性，应该独立于设备。我们提出了一个用于基于linux的固件映像的自动化设备无关仿真和动态分析框架FirmFuzz。它使用基于灰盒的分代模糊方法，并结合静态分析和系统内省，在固件映像中提供有针对性的、确定性的bug发现。我们通过模拟和动态分析32个图像(来自27个独特的设备)来评估FirmFuzz，网络可从执行模拟的主机访问。在测试过程中，FirmFuzz在6个不同的设备上发现了7个之前未披露的漏洞:两个IP摄像头和4个路由器。到目前为止，已经分配了4个CVE。 {% endspoiler %}\nWhat You Corrupt Is Not What You Crash: Challenges in Fuzzing Embedded Devices (2018) {% spoiler more %} {% post_link ‘paper-vfsf-2’ ‘Note’ %}\n随着网络化嵌入式系统越来越普遍，其安全性对我们的日常生活变得至关重要。虽然对这些系统进行手动或自动化的大规模分析会定期发现新的漏洞，但分析这些系统的方法通常与桌面系统中使用的方法相同。更具体地说，传统的测试方法依赖于可观察到的程序崩溃，二进制检测技术用于改进对这些错误状态的检测。 在本文中，我们演示了内存损坏(一种常见的安全漏洞)在嵌入式设备上导致的行为通常与桌面系统不同。特别是，在嵌入式设备上，内存损坏的影响通常不太明显。这大大降低了传统动态测试技术的有效性，特别是模糊。 此外，我们分析了几类嵌入式设备中的这些差异，并展示了对固件分析的结果影响。我们进一步描述和评估可以在运行时(在执行跟踪或在模拟器中)应用的相对简单的启发式方法，在分析嵌入式设备时检测以前未检测到的内存损坏。 {% endspoiler %}\nReal Device A Runtime Verification Tool for Detecting Concurrency Bugs in FreeRTOS Embedded Software (2018) {% spoiler more %} 本文介绍了一种用于嵌入式软件在开源实时操作系统FreeRTOS下运行的运行时验证工具。该工具可以检测和诊断并发bug，如死锁、饥饿和基于挂起的锁。该工具在运行时发现并发错误，而不需要调试和跟踪源代码。该工具使用Tracealyzer工具记录相关事件。通过分析日志，我们的工具可以通过应用单独诊断每种并发性bug类型的算法来检测并发性bug。 在本文中，我们介绍了该工具的实现，以及它的功能架构，并说明了它的使用。该工具可以在程序测试期间使用，以获得关于嵌入式软件执行的有趣信息。我们展示了在AVR 32位板SAM4S上运行该工具的一些典型bug示例的初始结果。 {% endspoiler %}\nIoTFuzzer: Discovering Memory Corruptions in IoT Through App-based Fuzzing (2018) {% spoiler more %} 随着越来越多的物联网设备进入消费市场，在攻击者之前检测它们的安全漏洞变得势在必行。现有的基于二进制分析的方法只在固件上工作，这是比较难访问的，除非那些配备了从设备提取代码的特殊工具。为了解决物联网安全分析中的这一挑战，我们在本文中提出了一种新的自动模糊化框架，称为IOTFUZZER，旨在发现在无法访问其固件映像的物联网设备中的内存破坏漏洞。其关键思想是基于这样一种观察，即大多数物联网设备都是通过其官方移动应用程序控制的，而这样的应用程序通常包含有关其用于与设备通信的协议的丰富信息。因此，通过识别和重用特定于程序的逻辑(例如，加密)来改变测试用例(特别是消息字段)，我们能够有效地探测物联网目标，而无需依赖任何关于其协议规范的知识。在我们的研究中，我们实现了iotfuzzer，并评估了17个运行在不同协议上的真实IoT设备，我们的方法成功识别了15个内存破坏漏洞(包括8个之前未知的漏洞)。 {% endspoiler %}\nRPFuzzer: A Framework for Discovering Router Protocols Vulnerabilities Based on Fuzzing (2013) {% spoiler more %} 如何有效、自动地发现路由器漏洞是保障网络和信息安全的关键问题。以往对路由器安全的研究主要集中在利用路由器已知缺陷的技术上。Fuzzing是一种著名的自动化漏洞发现技术;然而，传统的Fuzzing工具是为测试网络应用或其他软件而设计的。这些工具不适合或部分不适合测试路由器。本文设计了一个发现路由器协议漏洞的框架，并在已有的测试用例生成方法的基础上，提出了一个两阶段模糊测试用例生成器(TFTCG)的数学模型。我们开发了一个基于TFTCG的RPFuzzer工具。RPFuzzer通过发送正常的数据包、监视CPU利用率和检查系统日志来监控路由器，这些日志可以检测到DoS、路由器重启等。基于修改的Dynamips的RPFuzzer’调试器，它可以在发生异常时记录寄存器值。最后，我们在SNMP协议上进行实验，发现了8个漏洞，其中有5个未发布的漏洞。实验证明了该方法的有效性。 {% endspoiler %}\nEmulator FirmAE: Towards Large-Scale Emulation of IoT Firmware for Dynamic Analysis (2020) {% spoiler more %} FIRMADYNE改良 评估嵌入式物联网设备安全性的一种方法是对其固件进行动态分析，如模糊测试。为此，现有的方法旨在提供一个模拟真实硬件/外设行为的模拟环境。尽管如此，在实践中，这些方法只能模拟固件映像的一小部分。例如，我们从八大制造商那里收集到的1124张无线路由器/ ip摄像头图像中，最先进的工具Firmadyne只能显示183张(16.28%)。如此低的仿真成功率是由于真实的固件执行环境和仿真的固件执行环境不一致造成的。在本研究中，我们分析了大规模数据集中的模拟失败案例，以找出导致模拟率低的原因。我们发现，尽管根本原因不同，但使用简单的启发式方法往往可以避免广泛的故障情况，从而显著提高模拟的成功率。基于这些发现，我们提出了一种技术，仲裁模拟，并将几种启发式技术系统化，作为仲裁技术来解决这些故障。我们的自动化原型FirmAE成功地运行了1124个固件映像中的892个(79.36%)，其中包括web服务器，这比Firmadyne运行的映像多了很多(≈4.8倍)。最后，通过对仿真图像应用动态测试技术，FirmAE可以检测320个已知漏洞(比Firmadyne多306个)，并在23个设备中发现12个新的0天漏洞。 {% endspoiler %}\nFIRM-AFL: high-throughput greybox fuzzing of iot firmware via augmented process emulation (2019) {% spoiler more %} FIRMADYNE改良 针对物联网设备的网络攻击是一个严重的威胁。这些攻击利用了物联网固件的软件漏洞。摸索是一种有效的软件测试技术，用于发现漏洞。在这项工作中，我们提出了FIRM-AFL，这是第一个用于物联网固件的高通量灰盒模糊器。FIRM-AFL解决了物联网模糊测试的两个基本问题。首先，它通过对POSIX兼容的固件进行模糊处理来解决兼容性问题，这些固件可以在系统仿真器中模拟。其次，它通过一种称为增强进程仿真的新技术解决了系统模式仿真造成的性能瓶颈问题。通过将系统模式仿真和用户模式仿真以一种新颖的方式结合起来，增强的进程仿真提供了系统模式仿真的高兼容性和用户模式仿真的高吞吐量。我们的评估结果显示：（1）FIRM-AFL功能齐全，能够发现物联网程序中的真实漏洞；（2）FIRM-AFL的吞吐量平均比基于系统模式仿真的模糊测试高8.2倍；（3）FIRM-AFL能够比基于系统模式仿真的模糊测试更快地发现1天的漏洞，并且能够发现0-day的漏洞。 {% endspoiler %}\nTowards Automated Dynamic Analysis for Linux-based Embedded Firmware (2016) {% spoiler more %} {% post_link ‘paper-vfsf-3’ ‘Note’ %} 商用现货(COTS)网络支持的嵌入式设备通常由供应商固件控制，在我们的日常生活中执行不可或缺的功能。例如，家庭无线路由器通常是将家庭用户的个人计算和信息设备与互联网隔离开来的第一道也是唯一一道防线。在用户网络中这样一个至关重要的特权位置要求这些设备安全地运行。不幸的是，最近的研究和传闻证据表明，世界各地部署的设备根本不支持这种安全假设。 评估此类嵌入式设备固件安全性的第一步是准确识别漏洞。然而，市场提供了各种各样的嵌入式设备，这严重影响了该领域现有方法的可扩展性。在本文中，我们提出了FIRMADYNE，这是第一个自动化的动态分析系统，以可伸缩的方式专门针对网络连接COTS设备上基于linux的固件。我们确定了一系列固有于COTS固件动态分析的挑战，并讨论了我们的设计决策如何解决它们。在其核心，FIRMADYNE依赖于基于软件的完整系统模拟和一个仪表化内核，以实现自动分析数千个固件二进制文件所需的可伸缩性。 我们通过收集42家设备供应商的23,035个固件图像的真实数据集，对FIRMADYNE进行了评估。使用我们的系统可以成功提取的9486个固件映像上的74个漏洞样本，我们发现跨越至少89个不同产品的887个固件映像容易受到一个或多个采样漏洞的攻击。其中包括在我们的框架帮助下发现的14个以前未知的漏洞，这些漏洞影响至少12个不同产品的69个固件映像。此外，我们的结果显示，我们测试的11次攻击影响了来自多个供应商的固件映像，这表明代码共享和通用上游制造商(oem)非常普遍。 {% endspoiler %}\nHardware-in-the-loop（HITL） Avatar2: A Multi-target Orchestration Platform (2018) {% spoiler more %} 动态二进制分析技术在研究软件系统的安全性和检测广泛的设备和应用中的漏洞方面发挥着核心作用。在过去的十年中，已经发布了各种不同的技术，通常伴随着原型工具的发布来证明它们的有效性。不幸的是，这些技术的大多数实现都与它们的动态分析框架深度耦合，并且不容易集成到其他框架中。这些框架的设计目的不是向其他组件公开它们的内部状态或结果。这使得分析人员无法将不同的工具组合在一起，以利用它们的优势并解决需要复杂技术组合的复杂问题。碎片化和隔离是两个非常重要的问题，它们常常导致对同一问题的重复工作或多个等效解决方案——每个解决方案都基于不同的编程语言、抽象模型或执行环境。 在本文中，我们提出了avatar2，一个动态多目标编制框架，旨在实现不同动态二进制分析框架、调试器、模拟器和真实物理设备之间的互操作性。Avatar2允许分析师在复杂的拓扑结构中组织不同的工具，然后将二进制代码的执行从一个系统“移动”到另一个系统。该框架支持设备/应用程序内部状态的自动传输，以及对物理外设或模拟目标的输入/输出和内存访问的可配置转发。 为了演示avatar2的使用和通用性，在本文中，我们展示了三个非常不同的用例，其中我们复制了一个在NDSS 2017上展示的PLC rootkit，我们结合Angr和GDB测试Firefox，我们使用PANDA和OpenOCD记录嵌入式设备固件的执行情况。所有的工具和三个用例将作为开源发布，以帮助其他研究人员复制我们的实验，并使用avatar2执行他们自己的分析任务。 {% endspoiler %}\nSURROGATES: Enabling Near-Real-Time Dynamic Analyses of Embedded Systems (2015) {% spoiler more %} 嵌入式系统正变得越来越复杂、相互连接和普及。不幸的是，保护这些系统仍然具有挑战性。虽然已经为传统软件开发了强大的动态分析工具，但嵌入式系统的独特特性使这些众所周知的技术难以应用;以前的工作仅限于小系统或短代码段。在本文中，我们演示了一个系统，它能够在接近实时的情况下对嵌入式系统进行仿真和测量，使各种动态分析技术成为可能。我们的方法在主机的spci Express总线和被测系统之间使用一个定制的、低延迟的FPGA桥接器，允许模拟器完全访问系统的外设。这为模拟器提供了固件正常执行环境的真实表示，支持额外的动态分析技术，如concolic执行。我们讨论了设计决策和工程权衡，并根据之前的工作评估我们的系统。 {% endspoiler %}\nAVATAR: A framework to support dynamic security analysis of embedded systems’ firmwares (2014) {% spoiler more %} 为了解决对嵌入式系统安全性日益增长的关注，对固件二进制文件进行准确的分析是很重要的，即使在源代码或硬件文档不可用的情况下。然而，由于缺乏专门的研究工具，这一领域的研究受到了阻碍。例如，动态分析是安全分析的主要基础之一，例如，通过动态污染跟踪或符号执行。与静态分析不同，动态分析依赖于在受控环境中执行软件的能力，通常是一个仪表化的模拟器。然而，模拟嵌入式设备的固件需要被分析的系统所使用的所有硬件组件的精确模型。不幸的是，缺乏文档和市场上各种各样的硬件使得这种方法在实践中不可行。 在这篇文章中，我们提出了Avatar，一个通过协调模拟器和真实硬件的执行来实现嵌入式设备复杂动态分析的框架。首先介绍了将I/O访问从模拟器转发到嵌入式设备的基本机制，然后描述了通过动态优化两种环境之间的代码和数据分布来提高系统性能的几种技术。最后，我们通过将其应用于三种不同的安全场景来评估我们的工具，包括反向工程、漏洞发现和硬编码后门检测。为了展示Avatar的灵活性，我们在三个完全不同的设备上进行分析:GSM功能手机、硬盘引导加载程序和无线传感器节点。 {% endspoiler %}\nRe-hosting Automatic Firmware Emulation through Invalidity-guided Knowledge Inference (2021) {% spoiler more %} G.O.S.S.I.P 学术论文推荐 2022-01-19 uEmu 由于硬件和固件之间的紧密耦合，对微控制器进行固件仿真具有挑战性。这极大地阻碍了动态分析工具在固件分析中的应用。最先进的工作是通过观察未知外设的访问模式来自动建模，然后利用启发式来计算当未知外设寄存器被访问时的适当响应。但是，我们根据经验发现，这种方法和相应的启发式方法通常不足以模拟固件。在这项工作中，我们提出了一种新的方法，称为μEmu来模拟固件与未知的外设。与试图为每个外设构建通用模型的现有工作不同，我们的方法学习如何正确地模拟在各个外设访问点上的固件执行。它将图像作为输入，并通过将未知的外围寄存器表示为符号来象征性地执行它。在符号执行期间，它推断出响应未知外设访问的规则。这些规则存储在一个知识库中，在动态固件分析期间将引用该知识库。μEmu在外设驱动程序单元测试中，在没有任何人工辅助的情况下，达到93%的通过率。我们还用真实的固件样本评估μEmu，发现了新的bug。 {% endspoiler %}\nFirmGuide: Boosting the Capability of Rehosting Embedded Linux Kernels through Model-Guided Kernel Execution (2021) {% spoiler more %} Linux内核广泛应用于嵌入式系统中。为了理解对Linux内核的实际威胁，我们需要使用全系统模拟器(例如QEMU)执行动态分析。然而，由于硬件碎片化，例如各种类型的外设，QEMU目前不支持大多数嵌入式系统。虽然在重新托管固件方面取得了一些进展，但它主要集中在用户空间程序或简单的实时操作系统上。这项工作的目标是提高在QEMU中重新托管嵌入式Linux内核的能力。这样，通过利用QEMU上现成的工具，动态分析系统就可以首先应用于嵌入式Linux内核。因此，我们提出了一种称为模型引导内核执行的新技术。它结合了Linux内核中的外围设备抽象和内核-外围设备交互，以半自动生成外围设备模型，然后用这些模型合成新的QEMU虚拟机来启动动态分析。我们实现了一个名为FirmGuide的原型。它生成了9个功能完整的外围设备型号和64个最小功能覆盖26个soc。我们对6188个固件镜像的评估表明，它可以成功地在2个架构和22个版本中重新托管95%以上的Linux内核。它们都不能在普通的QEMU中重新托管。LTP基准测试的结果显示了重新托管的Linux内核的可靠性和健壮性。我们进一步在重新托管的Linux内核上执行两个安全应用程序，即漏洞分析和模糊处理，以演示使用场景。 {% endspoiler %}\nHALucinator: Firmware Re-hosting Through Abstraction Layer Emulation (2020) {% spoiler more %} 考虑到在线嵌入式设备的日益普及，分析其固件对安全性、隐私性和安全性非常重要。硬件和固件之间的紧密耦合以及嵌入式系统的多样性使固件难以进行动态分析。然而，固件开发人员经常使用抽象来开发代码，例如硬件抽象层(HALs)，以简化他们的工作。我们利用这些抽象作为重新托管和分析固件的基础。通过提供HAL功能的高级替换(称为高级仿真- HLE的过程)，我们将硬件与固件解耦。这种方法首先通过二进制分析定位固件示例中的库函数，然后在整个系统模拟器中提供这些函数的一般实现。 我们在一个原型系统HALucinator中提出了这些想法，该系统能够重新托管固件，并允许虚拟设备正常使用。首先，我们引入了对现有库匹配技术的扩展，这些技术需要在二进制固件中识别库函数，以减少冲突，并推断额外的函数名。接下来，我们将通过使用简化的处理程序和外围设备模型来演示重新托管过程，这将使该过程在固件样本和芯片供应商之间快速、灵活和可移植。最后，通过对HALucinator和美国Fuzzy Lop fuzzer进行补充，我们证明了HLE用于安全分析的实用性，以定位固件中间件库中先前未知的多个漏洞。 {% endspoiler %}\nDevice-agnostic Firmware Execution is Possible: A Concolic Execution Approach for Peripheral Emulation (2020) {% spoiler more %} 随着物联网设备的迅速普及，我们的网络空间如今由数十亿低成本的计算节点主导，这些节点彼此之间非常异构。动态分析是发现软件bug的最有效的方法之一，但由于缺乏能够运行各种以前看不到的固件的通用模拟器，动态分析已经陷入瘫痪。近年来，我们目睹了针对基于微控制器的低端物联网设备的破坏性安全漏洞。这些安全问题严重阻碍了物联网技术的进一步发展。在这项工作中，我们提出了Laelaps，一个专门设计的设备模拟器，以运行各种软件的微控制器设备。我们不会将任何关于设备的特定信息编码到模拟器中。相反，Laelaps通过符号执行辅助的外围模拟来推断固件的预期行为，并生成适当的输入来实时控制具体的执行。这种独特的设计特性使Laelaps能够运行不同的固件，而无需预先了解目标设备。为了演示Laelaps的功能，我们在模拟器上应用了动态分析技术。我们成功地识别了自我注入的和现实世界的漏洞。 {% endspoiler %}\nDICE: Automatic Emulation of DMA Input Channels for Dynamic Firmware Analysis (2020) {% spoiler more %} 基于微控制器的嵌入式设备是物联网(IoT)和信息物理系统(CPS)的核心。这些设备的安全至关重要。在保护嵌入式设备安全的方法中，动态固件分析(例如漏洞检测)由于其脱机特性和较低的假阳性率，最近受到了极大的关注。然而，无论使用何种分析和仿真技术，现有的动态固件分析器都有一个主要的限制，即无法使用DMA(直接内存访问)处理固件。它严重限制了支持的设备类型和固件代码覆盖范围。 我们提出了DICE，一种用于固件分析器模拟DMA输入通道和生成或操作DMA输入(从外设到固件)的临时解决方案。DICE被设计为独立于硬件(即不需要实际的外设或DMA控制器)，并兼容常见的MCU固件(即不假设特定于固件的DMA使用)和嵌入式架构。DICE背后的高级思想是识别和模拟抽象的DMA输入通道，而不是高度多样化的外围设备和控制器。当固件将源DMA传输指针和目标DMA传输指针写入DMA控制器时，DICE识别DMA输入通道。然后，DICE代表固件分析器操作通过DMA传输的输入。DICE不需要固件源代码或固件分析器提供的其他功能。 我们将DICE集成到最近提出的固件分析器P2IM(用于ARM Cortex-M架构)和PIC32模拟器(用于MIPS M4K/M-Class架构)。我们在83个基准测试和样本固件上评估了它，代表了来自5个不同供应商的9个不同的DMA控制器。DICE检测到37个DMA输入通道中的33个，0个假阳性。它正确地为固件实际使用的22个DMA缓冲区中的21个提供了DMA输入，这是由于缺乏DMA模拟，以前的固件分析器无法实现的。DICE的开销相当低，它平均增加了3.4%的P2IM执行时间。我们还使用DICE对7个真实世界的固件进行了模糊测试，并将结果与原始P2IM进行了比较。DICE发现了更多的执行路径(多达79X)，并发现了5个以前不知道的独特bug，这些bug在没有DMA模拟的情况下无法访问。我们所有的源代码和数据集都是公开的。 {% endspoiler %}\nP2IM: Scalable and Hardware-independent Firmware Testing via Automatic Peripheral Interface Modeling(2020) {% spoiler more %} 嵌入式固件的动态测试或模糊严重限制了硬件依赖和较差的可伸缩性，部分导致了普遍存在的脆弱的物联网设备。我们提出了一种软件框架，它可以持续地执行给定的固件二进制文件，同时从现成的模糊器引导输入，从而支持独立于硬件的、可扩展的固件测试。我们的框架使用了一种名为P2IM的新技术，对各种外设进行抽象，并根据自动生成的模型动态地处理固件I/O。P2IM与外围设备设计无关，与固件实现通用，因此适用于广泛的嵌入式设备。我们使用70个样本固件和10个来自真实设备(包括无人机、机器人和PLC)的固件来评估我们的框架。在没有任何人工协助的情况下，它成功地执行了79%的样本固件。我们还对真实的固件进行了有限的模糊测试，发现了7个独特的未知bug。 {% endspoiler %}\nToward the Analysis of Embedded Firmware through Automated Re-hosting (2019) {% spoiler more %} 最近物联网(IoT)带来的范式转变使嵌入式系统成为安全分析师和恶意对手的目标。物联网设备缺乏标准化的硬件、多样化的软件和不透明的功能，由于其固件和设计的硬件之间的紧密耦合，给安全分析师带来了独特的挑战。为了利用现代程序分析技术，如模糊或符号执行，以任何类型的规模或深度，分析人员必须有能力在模拟(或虚拟化)环境中执行固件代码。然而，这些仿真环境很少可用，并且通过手动反向工程创建起来很麻烦，这极大地限制了二进制固件的分析。在本文中，我们探讨了固件重新托管的问题，即固件从其原始硬件环境迁移到虚拟化环境的过程。我们展示了一种能够以自动化方式创建虚拟交互环境的方法，这是实现大规模固件分析的必要条件。我们提出了旨在实现这一目标的第一个概念验证系统，称为PRETENDER，它使用对原始硬件和固件之间交互的观察来自动创建外设的模型，并允许在完全模拟的环境中执行固件。与以前的方法不同，这些模型是交互式的、有状态的和可转移的，这意味着它们被设计为允许程序接收和处理新的输入，这是许多分析的需求。我们在多个硬件平台和固件示例上演示了我们的方法，并展示了模型足够灵活，以允许虚拟化代码执行、探索新的代码路径和识别安全漏洞。 {% endspoiler %}\nStatic Analysis Karonte: Detecting Insecure Multi-binary Interactions in Embedded Firmware (2020) {% spoiler more %} 低功耗、单一用途的嵌入式设备（例如路由器和物联网设备）已经无处不在。虽然它们自动化并简化了用户生活的许多方面，但最近的大规模攻击表明，它们的数量对互联网基础设施构成了严重威胁。不幸的是，这些系统上的软件依赖于硬件，并且通常在具有非标准配置的独特、最小环境中执行，这使得安全分析特别具有挑战性。许多现有设备通过使用多个二进制文件来实现其功能。这种多二进制服务实现使当前的静态和动态分析技术无效或低效，因为它们无法识别和充分建模各种可执行文件之间的通信。在本文中，我们介绍了 KARONTE，这是一种静态分析方法，能够通过建模和跟踪多二进制交互来分析嵌入式设备固件。我们的方法在二进制文件之间传播污染信息以检测不安全的交互并识别漏洞。我们首先在来自不同供应商的 53 个固件样本上评估了 KARONTE，表明我们的原型工具可以成功地跟踪和约束多二进制交互。这导致发现了 46 个零日漏洞。然后，我们对 899 个不同的样本进行了大规模实验，表明 KARONTE 可以很好地适应不同大小和复杂性的固件样本。 {% endspoiler %}\nFirmalice - Automatic Detection of Authentication Bypass Vulnerabilities in Binary Firmware (2015) {% spoiler more %} 嵌入式设备已经无处不在，它们被用于一系列隐私敏感和安全关键的应用程序中。这些设备中的大多数都运行专有软件，几乎没有关于软件内部工作的文档。在某些情况下，硬件和保护机制的成本可能会使访问设备本身变得不可行。如果必须避免与软件错误和漏洞相关的风险，则分析此类环境中存在的软件具有挑战性，但也是必要的。事实上，最近的研究表明，市场上的许多嵌入式设备都存在后门。在本文中，我们介绍了 Firmalice，这是一个二进制分析框架，用于支持分析在嵌入式设备上运行的固件。 Firmalice 建立在符号执行引擎和程序切片等技术之上，以提高其可扩展性。此外，Firmalice 利用一种新颖的身份验证绕过漏洞模型，基于攻击者确定执行特权操作所需输入的能力。我们在三个市售设备的固件上评估了 Firmalice，并且能够在其中两个设备中检测到身份验证绕过后门。此外，Firmalice 能够确定第三个固件样本中的后门不能被攻击者在不知道一组非特权凭证的情况下利用。 {% endspoiler %}\nGeneral Symoblic Execution SymQEMU:Compilation-based symbolic execution for binaries (2021) {% spoiler more %} 带你搞懂符号执行的前世今生与最近技术 符号执行是一种强大的软件分析和错误检测技术。基于编译的符号执行是最近提出的一种风格，已被证明可以在源代码可用时显着提高符号执行的性能。我们展示了一种新技术，可以实现基于编译的二进制符号执行（即，无需源代码）。我们的系统 SymQEMU 构建在 QEMU 之上，在将目标程序转换为主机架构之前修改目标程序的中间表示。这使 SymQEMU 能够将符号执行功能编译到二进制文件中，并在保持架构独立性的同时获得相关的性能优势。 我们展示了我们的方法和实现，并证明它在统计上优于最先进的二进制符号执行器 S2E 和 QSYM；在某些基准测试中，它甚至比基于源代码的 SymCC 获得了更好的性能。此外，我们的工具在经过良好测试的 libarchive 库中发现了一个以前未知的漏洞，证明了它在测试真实世界软件中的实用性。 {% endspoiler %}\nSystematic Comparison of Symbolic Execution Systems: Intermediate Representation and its Generation (2019) {% spoiler more %} 符号执行已成为一种流行的软件测试和漏洞检测技术。大多数实现将正在分析的程序转换为某种中间表示 (IR)，然后将其用作符号执行的基础。有大量可用的 IR，甚至还有更多方法可以将目标程序转换为相应的 IR。 在开发符号执行引擎时，需要选择一个 IR，但不清楚 IR 生成过程对生成的系统有何影响。从源代码生成 IR 与提升机器代码的符号执行各自有什么好处？区别甚至重要吗？不使用 IR，直接执行机器代码有什么影响？我们认为几乎没有科学证据支持这些问题的答案。因此，我们首先开发了一种系统比较符号执行的不同方法的方法；然后，我们用它来评估选择 IR 和 IR 生成的影响。我们将我们的比较框架提供给社区以供未来研究。 {% endspoiler %}\nA Survey of Symbolic Execution Techniques (2016) {% spoiler more %} 许多安全和软件测试应用程序需要检查程序的某些属性是否适用于任何可能的使用场景。例如，用于识别软件漏洞的工具可能需要排除任何后门的存在以绕过程序的身份验证。一种方法是使用不同的、可能是随机的输入来测试程序。由于后门可能只针对非常特定的程序工作负载而受到攻击，因此对可能输入空间的自动探索至关重要。符号执行通过系统地同时探索许多可能的执行路径而不必需要具体的输入，为该问题提供了一个优雅的解决方案。该技术不是采用完全指定的输入值，而是将它们抽象地表示为符号，诉诸约束求解器来构造可能导致属性违规的实际实例。符号执行在过去 4 年中开发的数十种工具中得到了孵化，在许多著名的软件可靠性应用程序中取得了重大的实际突破。本次调查的目的是概述该领域开发的主要想法、挑战和解决方案，并将其提炼给广大受众。 {% endspoiler %}\n(State of) The Art of War: Offensive Techniques in Binary Analysis (2016) {% spoiler more %} 寻找和利用二进制代码中的漏洞是一项具有挑战性的任务。缺乏有关数据结构和控制结构的高层次、语义丰富的信息使得对程序属性的分析难以扩展。然而，二元分析的重要性正在上升。在许多情况下，二进制分析是唯一可能证明(或否定)实际执行的代码属性的方法。 在本文中，我们提出了一个二元分析框架，它实现了过去提出的许多分析技术。我们提出了这些技术的系统化实现，这允许其他研究人员组合他们，并开发新的方法。此外，在统一的框架中实现这些技术允许对这些方法进行直接比较，并确定它们的优点和缺点。本文所包含的评估是使用DARPA创建的用于评估二进制漏洞分析技术有效性的最新数据集进行的。 我们的框架是开源的，安全社区可以使用。 {% endspoiler %}\nVehicle Cyber–Physical Security of Powertrain Systems in Modern Electric Vehicles: Vulnerabilities, Challenges, and Future Visions (2021) {% spoiler more %} {% post_link ‘paper-vfsf-7’ ‘Note’ %} 由于电力电子系统在物联网(IoT)应用领域(包括联网电动汽车)的日益普及，它们越来越容易受到网络物理威胁。为了响应这一新兴需求，IEEE电力电子学会(peles)最近发起了一项网络物理安全倡议。随着V2X (vehicle-to-everything)和电子控制单元数量的增加，联网电动汽车面临着更大的网络物理安全挑战。然而，现有的研究主要集中在内燃机汽车的网络安全方面，并没有具体解决电动汽车的网络物理安全问题。本文从固件安全、车辆充电安全、动力系统控制安全等方面探讨了联网电动汽车网络物理安全面临的挑战和未来前景。在各种网络攻击下，电动汽车的漏洞被调查，从能源效率驱动的攻击到安全驱动的攻击。仿真结果包括硬件在环(HIL)结果，进一步分析了网络攻击对转换器(设备)和车辆(系统)级别的影响。更重要的是，下一代电力电子系统的架构被提出，以解决电动汽车的网络物理安全挑战。最后，详细讨论了潜在的研究机会，包括针对固件安全性的检测和迁移、基于模型和数据驱动的检测和缓解。据我们所知，这是首次对现代电动汽车动力系统的网络物理安全进行全面研究。 {% endspoiler %}\nA Brief Survey on Autonomous Vehicle Possible Attacks,Exploits and Vulnerabilities (2021) {% spoiler more %} {% post_link ‘paper-vfsf-8’ ‘Note’ %} 先进的驾驶辅助系统正在快速发展，各大企业都开始投资开发自动驾驶汽车。但安全性和可靠性仍然是不确定和有争议的。想象一下，一辆车被攻击者破坏了，然后他们能做什么。攻击者可以控制刹车，加速，甚至转向，这可以导致灾难性的后果。本文简要概述了自动驾驶汽车软件和硬件可能受到的大多数攻击及其潜在影响。 {% endspoiler %}\nResearch on Detection and Evaluation Technology of Cybersecurity in Intelligent and Connected Vehicle (2019) {% spoiler more %} {% post_link ‘paper-vfsf-6’ ‘Note’ %} 随着汽车智能化和网络互联的不断发展，智能联网汽车(ICV)的网络安全问题日益突出。但目前汽车行业缺乏软件测试工具，缺乏网络安全检测与评估是亟待解决的严重问题。本文针对这一问题，开展了ICV检测评估平台的研究，并对ICV网络安全检测技术进行了探索。此外，我们建立汽车网络安全漏洞数据库提供数据支撑，利用源代码分析、固件反向、渗透测试、仿真等检测技术，对汽车终端、数据通信、云平台、APP等进行网络安全评估。设计全检测和风险评估，构建ICV安全检测评估平台。 {% endspoiler %}\nOther Reference Recent Papers Related To Fuzzing ","wordCount":"18717","inLanguage":"zh","datePublished":"2022-07-10T17:27:17+08:00","dateModified":"2022-07-10T17:27:17+08:00","author":{"@type":"Person","name":"Eveneko"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://eveneko.com/posts/firmware-readpaper/"},"publisher":{"@type":"Organization","name":"Neko Nest","logo":{"@type":"ImageObject","url":"https://eveneko.com/images/logo.svg"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://eveneko.com accesskey=h title="Neko Nest (Alt + H)"><img src=https://eveneko.com/images/logo.svg alt aria-label=logo height=35>Neko Nest</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://eveneko.com/search/ title="🔍 搜索"><span>🔍 搜索</span></a></li><li><a href=https://eveneko.com/archives/ title="🕙 时间轴"><span>🕙 时间轴</span></a></li><li><a href=https://eveneko.com/categories/ title="🧩 分类"><span>🧩 分类</span></a></li><li><a href=https://eveneko.com/tags/ title="🏷️ 标签"><span>🏷️ 标签</span></a></li><li><a href=https://eveneko.com/about/ title="🙋🏻‍♂️ 关于"><span>🙋🏻‍♂️ 关于</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://eveneko.com>主页</a>&nbsp;»&nbsp;<a href=https://eveneko.com/posts/>Posts</a></div><h1 class=post-title>Firmware Readpaper</h1><div class=post-meta>&lt;span title='2022-07-10 17:27:17 +0800 +0800'>2022-07-10&lt;/span>&amp;nbsp;·&amp;nbsp;38 分钟&amp;nbsp;·&amp;nbsp;18717 字&amp;nbsp;·&amp;nbsp;Eveneko&nbsp;|&nbsp;<a href=https://github.com/Eveneko/Blob-Source/edit/master/content/posts/firmware-readpaper/index.md rel="noopener noreferrer" target=_blank>Edit on GitHub</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>目录</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#all-papersclassification-according-to-subject>All Papers(Classification according to Subject)</a><ul><li><a href=#surveyreview>Survey/Review</a></li><li><a href=#general-fuzzing>General Fuzzing</a></li><li><a href=#firmware-fuzzing>Firmware Fuzzing</a></li><li><a href=#real-device>Real Device</a></li><li><a href=#emulator>Emulator</a></li><li><a href=#hardware-in-the-loophitl>Hardware-in-the-loop（HITL）</a></li><li><a href=#re-hosting>Re-hosting</a></li><li><a href=#static-analysis>Static Analysis</a></li><li><a href=#general-symoblic-execution>General Symoblic Execution</a></li><li><a href=#vehicle>Vehicle</a></li><li><a href=#other>Other</a></li></ul></li><li><a href=#reference>Reference</a></li></ul></nav></div></details></div><div class=post-content><p>本页面收录和车辆固件在模拟环境下模糊测试相关的论文。(43篇)</p><h2 id=all-papersclassification-according-to-subject>All Papers(Classification according to Subject)<a hidden class=anchor aria-hidden=true href=#all-papersclassification-according-to-subject>#</a></h2><h3 id=surveyreview>Survey/Review<a hidden class=anchor aria-hidden=true href=#surveyreview>#</a></h3><ul><li><p><a href=https://ieeexplore.ieee.org/abstract/document/9878283/>Detecting Vulnerability on IoT Device Firmware: A Survey</a> (2022)
{% spoiler more %}
物联网 (IoT) 设备占所有网络连接端点的 30%，引入了漏洞和新颖的攻击，使许多公司成为网络犯罪分子的主要目标。为了应对这种日益增加的威胁面，每个部署物联网设备的组织都需要考虑安全风险，以确保这些设备的安全和可信。在所有安全风险解决方案中，固件安全分析对于修复软件错误、修补漏洞或添加新的安全功能以保护易受攻击设备的用户至关重要。然而，由于执行环境的多样性和固件的密切来源，固件安全分析从来都不是一件容易的事。这两个不同的功能使解压固件样本以进行详细分析的操作变得复杂。它们还使得创建视觉环境来模拟设备固件的运行变得困难。尽管研究人员在过去十年中开发了许多新方法来克服各种挑战，但在实践中，关键障碍阻碍了固件安全分析。因此，本次调查旨在系统地回顾和分析研究挑战及其解决方案，同时考虑广度和深度。具体来说，根据分析的角度，介绍了对物联网设备进行安全分析的各种方法，并将其分为四类。详细讨论了每个类别中的挑战，随后提出了潜在的解决方案。然后，我们讨论了这些解决方案的缺陷，并为该研究领域提供了未来的方向。包括软件开发人员、网络安全研究人员和软件安全工程师在内的广大读者可以利用本调查来更好地了解固件安全分析。
{% endspoiler %}</p></li><li><p><a href=https://dl.acm.org/doi/abs/10.1145/3512345>Fuzzing: A Survey for Roadmap</a> (2022)
{% spoiler more %}
<a href=https://mp.weixin.qq.com/s/_Xe2bHaxjeY_zhwLuXlwZg>G.O.S.S.I.P 学术论文推荐 2022-02-28 Fuzzing: A Survey for Roadmap</a></p></li></ul><p>模糊测试(fuzzing)是近年来在安全法律检测领域兴起的一种方法。它生成大量的测试用例，并监视缺陷的执行。Fuzzing已经在各种应用程序中发现了数千个bug和漏洞。虽然有效，但缺乏对模糊所面临的空白的系统分析。模糊化作为一种缺陷检测技术，需要缩小整个输入空间与缺陷空间之间的差距。不限制生成的输入，输入空间是无限大的。然而，缺陷在应用程序中是稀疏的，这表明缺陷空间比整个输入空间小得多。此外，由于fuzzing会产生大量的测试用例来反复检查目标，因此需要fuzzing以自动的方式执行。由于应用程序的复杂性和缺陷，对不同应用程序的自动化执行具有挑战性。在本文中，我们从广度和深度两方面系统地回顾和分析了这些差距及其解决方案。这个调查可以成为初学者和高级开发人员更好地理解模糊的路线图。
{% endspoiler %}</p><ul><li><a href=https://dl.acm.org/doi/abs/10.1145/3423167>Challenges in Firmware Re-Hosting, Emulation, and Analysis</a> (2021)
{% spoiler more %}</li></ul><p>{% endspoiler %}</p><ul><li><a href=https://crad.ict.ac.cn/CN/10.7544/issn1000-1239.2021.20201018>A Review of Fuzzing Techniques</a> (2021)
{% spoiler more %}
{% post_link &lsquo;paper-vfsf-1&rsquo; &lsquo;Note&rsquo; %}</li></ul><p>模糊测试是一种安全测试技术,主要用于检测安全漏洞,近几年模糊测试技术经历了快速发展,因此有必要对相关成果进行总结和分析．通过搜集和分析网络与系统安全国际四大顶级安全会议(IEEES&amp;P,USENIXSecurity,CCS,NDSS)中相关的文章,总结出模糊测试的基本工作流程,包括:预处理、输入数据构造、输入选择、评估、结果分析这５个环节,针对每个环节中面临的任务以及挑战,结合相应的研究成果进行分析和总结,其中重点分析以 American Fuzzy Lop 工具及其改进成果为代表的,基于覆盖率引导的模糊测试方法．模糊测试技术在不同领域中使用时,面对着巨大的差异性,通过对相应文献进行整理和分析,总结出特定领域中使用模糊测试的独特需求以及相应的解决方法,重点关注物联网领域,以及内核安全领域．近些年反模糊测试技术以及机器学习技术的进步,给模糊测技术的发展带来了挑战和机遇,这些机遇和挑战为下一步的研究提供了方向参考．
{% endspoiler %}</p><ul><li><p><a href=https://people.ece.ubc.ca/amesbah/resources/papers/iot-icse21.pdf>IoT Bugs and Development Challenges</a> (2021)
{% spoiler more %}
物联网系统迅速应用于各个领域，从嵌入式系统到智能家居。尽管物联网的采用和普及程度越来越高，但目前还没有深入的研究来从从业者的角度了解物联网发展面临的挑战。我们通过大规模的实证调查，首次系统地研究了物联网开发人员在实践中面临的bug和挑战。我们从91个具有代表性的物联网项目存储库中收集了5565个bug报告，并根据观察到的故障、根本原因和故障组件的位置对323个随机样本进行了分类。此外，我们对物联网专家进行了9次访谈，以揭示物联网bug的更多细节，并深入了解物联网开发人员面临的挑战。最后，我们调查了194名IoT开发人员，以验证我们的发现并获得进一步的见解。基于我们的研究结果，我们提出了物联网系统的第一个bug分类。我们强调了常见的bug类别及其根本原因、它们之间的相关性，以及物联网开发人员面临的常见陷阱和挑战。我们为需要关注的物联网领域推荐未来的发展方向。索引术语-物联网，软件工程，挖掘软件库，实证研究。
{% endspoiler %}</p></li><li><p><a href=http://cjc.ict.ac.cn/online/onlinepaper/yyc-202159171541.pdf>嵌入式设备固件安全分析技术研究</a> (2021)
{% spoiler more %}
{% post_link &lsquo;paper-vfsf-5&rsquo; &lsquo;Note&rsquo; %}</p></li></ul><p>随着嵌入式设备的种类和数量的增加，设备之间日益增长的互联互通、制造商对安全的忽视、设备固件更 新不及时或难以更新等，使得嵌入式设备的安全受到了严峻的考验，越来越多的设备漏洞被披露．但由于嵌入式设 备种类繁多、专用性强、源码或设计文档往往不公开、运行环境受限等诸多因素的影响，通用漏洞挖掘技术无法直 接适配．近年来，国内外安全专家和学者针对嵌入式设备及其固件的安全分析和测评技术提出了很多切实可行的 解决方案，但缺乏详细和全面介绍最新安全研究成果的论文，使得安全分析人员难以系统地了解嵌入式设备及其 固件安全分析技术的研究进展．本文围绕着当前嵌入式设备固件面临的安全风险，分析和总结了国内外最新的研 究成果，并对相关安全技术进行了综合分析和评估．首先对嵌入式设备及其固件的表现形式、分类及获取方法、面 临的安全攻击层面以及自动化解析情况进行了深入研究．然后，对嵌入式设备固件安全分析技术进行了细化分析，从静态分析、符号执行、二进制漏洞关联、动态分析平台和模糊测试等五个方面进行了详细分析和横向评估．最后 对未来的研究方向进行了展望。
{% endspoiler %}</p><ul><li><a href=https://dl.acm.org/doi/abs/10.1145/3457913.3457934>Firmware Fuzzing: The State of the Art</a> (2020)
{% spoiler more %}
{% post_link &lsquo;paper-vfsf-4&rsquo; &lsquo;Note&rsquo; %}</li></ul><p>背景:固件是物联网设备的使能软件，其软件漏洞是物联网设备被利用的主要原因之一。由于物联网设备资源有限，部署复杂的运行时保护技术是不切实际的。在不安全的网络环境下，当固件被利用时，可能会导致拒绝服务、信息泄露、特权提升，甚至危及生命。因此，利用模糊技术进行固件漏洞检测已成为保障物联网设备安全的关键，也成为学术界和工业界研究的热点。随着现有物联网设备的快速增长、固件的规模和复杂性、固件类型的多样性以及固件的缺陷，现有的物联网固件模糊化方法面临挑战。
目的:总结物联网固件模糊化方法的典型类型，分析这些工作的贡献，总结现有模糊化方法的不足。
方法:设计几个研究问题，从研究问题中提取关键词，利用关键词检索相关文献。
结果:根据固件的执行环境，我们将现有的固件模糊化工作分为基于真实设备的模糊化和基于仿真的模糊化，基于仿真的模糊化是未来的主流;我们发现现有模糊化方法主要针对的漏洞类型为内存破坏漏洞;固件模糊比普通软件模糊困难得多。
结论:通过分析不同方法的优缺点，本文为进一步提高模糊化技术的性能提供了指导，并根据本文的研究结果提出了几点建议。
{% endspoiler %}</p><ul><li><p><a href=https://wcventure.github.io/FuzzingPaper/Paper/TRel18_Fuzzing.pdf>Fuzzing: State of the Art</a> (2018)
{% spoiler more %}
模糊测试(fuzzing)是目前最流行的软件测试技术之一，它通过生成大量的测试输入，可以发现程序中的各种弱点，如软件bug和漏洞。由于其有效性，模糊被认为是一种有价值的bug搜索方法。在这篇论文中，我们提出了模糊化的概述，集中在其一般过程，以及分类，随后详细讨论了关键障碍和一些旨在克服或减轻这些障碍的最先进的技术。我们进一步研究和分类了几种广泛使用的模糊工具。我们的主要目标是让涉众更好地理解模糊，以及在软件测试和安全范围内改进模糊方法的潜在解决方案。为了启发未来的研究，我们还预测了模糊化的一些未来方向。
{% endspoiler %}</p></li><li><p><a href=https://arxiv.org/pdf/1812.00140.pdf>The Art, Science, and Engineering of Fuzzing: A Survey</a> (2018)
{% spoiler more %}
在当今可用的许多软件漏洞发现技术中，模糊分析由于其概念上的简单性、部署的低门槛以及在发现真实软件漏洞方面的大量经验证据而一直非常受欢迎。在较高的层次上，模糊是指重复运行程序的过程，所生成的输入可能在语法或语义上有缺陷。近年来，研究人员和从业人员都投入了大量和多样化的努力来改善模糊化，但这一工作的激增也使人们难以获得关于模糊化的全面和连贯的观点。为了帮助保持和使大量模糊化文献保持连贯性，本文提出了一个统一的、通用的模糊化模型，并对当前模糊化文献进行了分类。我们系统地探索模型模糊器每个阶段的设计决策，通过调查艺术、科学和工程方面的相关文献和创新，使现代模糊器有效。
{% endspoiler %}</p></li></ul><h3 id=general-fuzzing>General Fuzzing<a hidden class=anchor aria-hidden=true href=#general-fuzzing>#</a></h3><ul><li><a href=https://www.eurecom.fr/publication/6973/download/sec-publi-6973.pdf>LibAFL: A Framework to Build Modular and Reusable Fuzzers</a> (2022)
{% spoiler more %}
<a href=https://mp.weixin.qq.com/s/Aa9Q5d2sViXWjVOnsIzhSg>G.O.S.S.I.P 阅读推荐 2022-08-24 LibAFL</a></li></ul><p>AFL的发布标志着软件安全测试领域的一个重要里程碑，重新激活了fuzzing作为一个主要的研究课题，并激发了大量试图改进和评估fuzzing管道不同方面的研究。许多这样的研究通过AFL代码库分叉来实现他们的技术。虽然这个选择乍一看似乎是合适的，但将多个分叉组合成一个模糊器需要很高的工程开销，这将阻碍该领域的进展，并阻止对不同技术的公平和客观的评估。模糊生态系统的高度碎片化景观也阻止了研究人员结合正交技术，并使最终用户难以采用新的原型解决方案。为了解决这一问题，本文提出了一种模块化、可重用的模糊信号处理框架LibAFL。我们讨论了模糊处理中通常使用的不同组件，并将它们映射到一个可扩展的框架。LibAFL允许研究人员和工程师扩展核心模糊器管道，并为进一步评估共享他们的新组件。作为LibAFL的一部分，我们集成了20多个以前工作的技术，并进行了广泛的实验，以展示我们的框架在结合和评估不同方法方面的好处。我们希望这能帮助阐明当前模糊化的进展，并为未来的比较和可扩展的研究提供一个坚实的基础。
{% endspoiler %}</p><h3 id=firmware-fuzzing>Firmware Fuzzing<a hidden class=anchor aria-hidden=true href=#firmware-fuzzing>#</a></h3><ul><li><p><a href=https://www.usenix.org/system/files/sec22summer_scharnowski.pdf>Fuzzware: Using Precise MMIO Modeling for Effective Firmware Fuzzing</a> (2022)
{% spoiler more %}
随着嵌入式设备在我们的日常生活中越来越普遍，它们成为对手的一个诱人的目标。尽管它们具有很高的价值和较大的攻击面，但应用自动化测试技术(如模糊)对这类设备并不是很直接。由于在受限的嵌入式设备上对固件进行模糊测试效率低下，最先进的方法反而选择在模拟器中运行固件(通过一个称为重新托管的过程)。然而，现有的方法要么使用粗粒度的硬件行为静态模型，要么需要手工重新托管固件。我们提出了一种轻量级程序分析、重新托管和模糊测试的新组合来解决这些挑战。本文提出了一种软件专用系统FUZZWARE的设计与实现方法，该系统能够以一种可扩展的方式对未修改的单片固件进行模糊测试。通过确定硬件生成的值是如何被固件逻辑实际使用的，FUZZWARE可以自动生成模型，帮助将模糊处理集中在改变重要的输入上，这大大提高了它的效率。我们在包括19个硬件平台和77个固件图像的合成目标和真实目标上评估我们的方法。与最先进的工作相比，FUZZ-WARE实现了高达3.25倍的代码覆盖率，我们的建模方法减少了高达95.5%的输入空间的大小。合成样本包含66个针对各种硬件交互的单元测试，我们发现我们的方法是第一个自动通过所有单元测试的通用重新托管解决方案。FUZZWARE发现了15个全新的bug，包括其他作品之前分析的目标bug;总共分配了12个cve。
{% endspoiler %}</p></li><li><p><a href=https://ieeexplore.ieee.org/iel7/6287639/9312710/09489311.pdf>FIRM-COV: High-Coverage Greybox Fuzzing for IoT Firmware via Optimized Process Emulation</a> (2021)
{% spoiler more %}
随着物联网(IoT)的日益普及，相关的安全威胁也随之增加。动态检测物联网设备漏洞的必要性再怎么强调也不为过。在这项工作中，我们提出了FIRM-COV，这是第一个面向物联网固件的高覆盖率灰盒模糊器。FIRMCOV通过针对物联网程序和挖掘真实世界漏洞，利用最新优化的流程模拟。基于经验分析，利用结构化输入、仿真的不准确性和不稳定性以及对代码覆盖率的要求，致力于解决物联网模糊化问题。通过优化现有的仿真技术，FIRM-COV在检测漏洞时始终保持稳定状态，准确率较高。我们还实现字典生成算法，以提供结构化的输入值和协同调度，以实现高覆盖率和吞吐量。我们将FIRM-COV与其他针对8个真实物联网设备的物联网模糊框架进行比较。因此，FIRM-COV实现了最高的覆盖率和吞吐量，发现了最快和最多的1天漏洞，几乎没有误报。它还在24小时内发现了现实物联网设备中的两个0天漏洞。
{% endspoiler %}</p></li><li><p><a href=https://conand.me/publications/redini-diane-2021.pdf>DIANE: Identifying Fuzzing Triggers in Apps to Generate Under-constrained Inputs for IoT Devices</a> (2021)
{% spoiler more %}
物联网(IoT)设备已经根植于数十亿人的日常生活中。因此，研究人员已经应用自动bug查找技术来提高整体安全性。然而，由于提取和模拟自定义固件的困难，黑盒模糊往往是唯一可行的分析选择。不幸的是，这种解决方案大多会产生无效输入，这些输入会被目标物联网设备迅速丢弃，并且无法穿透其代码。另一种建议的方法是利用配套应用程序(即通常用于控制物联网设备的移动应用程序)来生成结构良好的模糊输入。不幸的是，现有的解决方案产生的模糊输入受到应用程序端验证代码的限制，从而大大限制了发现的漏洞的范围。在本文中，我们提出了一种新的方法来克服这些限制。我们的关键观察是，在配套的应用程序中存在可用于生成最佳(即有效但不受约束)模糊输入的函数。这样的函数，我们称之为模糊触发器，在任何数据转换函数(例如，网络序列化)之前执行，但在输入验证代码之后执行。因此，它们生成的输入不受应用端消毒代码的约束，同时，也不会因其格式无效而被分析的物联网设备丢弃。我们设计和开发了一款结合静态和动态分析的工具，在Android配套应用中寻找模糊触发点，然后使用它们自动模糊物联网设备。我们使用DIANE分析了11个流行的物联网设备，并识别了11个bug，其中9个是零天。我们的结果还表明，如果不使用模糊触发，就不可能为许多设备生成错误触发输入。
{% endspoiler %}</p></li><li><p><a href=https://ieeexplore.ieee.org/abstract/document/9237719/>FIRMNANO: Toward IoT Firmware Fuzzing Through Augmented Virtual Execution</a> (2020)
{% spoiler more %}
考虑到物联网设备的部署越来越广泛，这些设备的固件的安全分析是极其重要的。然而，现在大量的设备都存在漏洞，攻击者可以利用这些漏洞远程控制物联网设备。在本文中，我们展示了FIRMNANO，一个以微控制器为核心的fiot设备固件模糊化框架。FIRMNANO基于增强的虚拟执行，解决了微控制器固件仿真的三个关键问题:(1)MMIO区域访问(2)中断触发(3)DMA支持。在此基础上，对固件进行了基于代码覆盖的模糊测试。我们的评估结果表明，FIRMNANO可以正确地执行固件，并可用于真实的固件漏洞挖掘。
{% endspoiler %}</p></li><li><p><a href=https://eprints.whiterose.ac.uk/164791/1/TCAD3013046.pdf>EM-Fuzz: Augmented Firmware Fuzzing via Memory Checking</a> (2020)
{% spoiler more %}
在新兴的应用场景中，嵌入式系统的互联程度越来越高。这些应用程序中的许多都对安全至关重要，因此，确保系统免受恶意攻击是非常重要的。这项工作的目的是检测嵌入式固件中的漏洞，这些漏洞可能被对手利用来破坏功能的正确性，这是具有挑战性的，特别是由于缺乏源代码。特别地，我们提出EM-Fuzz，这是一种固件漏洞检测技术，它将fuzzing与实时内存检查紧密地集成在一起。基于内存检测的固件模糊化不仅可以通过传统的分支覆盖来引导生成高质量的种子来探测难以到达的区域，还可以通过记录的内存敏感操作来连续地锻炼容易被攻击的敏感区域。更重要的是，该检测集成了实时内存检查器来暴露内存漏洞，这是现有的没有源代码的模糊器所不能很好地支持的。在几个真实世界的嵌入式固件(如OpenSSL)上的实验表明，EM-Fuzz显著提高了最先进的模糊工具(如AFL和AFLFast)的性能，覆盖率分别提高了93.98%和46.89%。此外，EM-Fuzz总共暴露了23个漏洞，每个漏洞平均耗时约7小时。AFL和AFLFast总共发现了10个漏洞，平均每个漏洞花费的时间分别为13小时和10小时。在这23个漏洞中，有16个以前是未知的，并且已经报告给了上游产品供应商，其中7个在美国国家漏洞数据库中被分配了唯一的CVE标识符。
{% endspoiler %}</p></li><li><p><a href=https://onlinelibrary.wiley.com/doi/abs/10.1002/cpe.5756>Fw-fuzz: A code coverage-guided fuzzing framework for network protocols on firmware</a> (2020)
{% spoiler more %}
模糊化是一种利用可变生成输入检测软件漏洞的有效方法。然而，在物联网设备的固件上模糊网络协议受到测试用例生成、跨架构检测和故障检测效率低的限制。在本文中，我们提出了Fw-fuzz，这是一个覆盖引导的跨平台框架，用于模糊在嵌入式体系结构上的固件上下文中运行的网络服务，它可以通过内省程序运行时信息和使用遗传算法模型生成更多有价值的测试用例。具体地说，我们在Fw-fuzz中提出了新颖的动态工具来收集固件程序的运行状态。Fw-fuzz采用一种遗传算法模型指导代码覆盖率高的输入生成。我们全面实现了Fw-fuzz的原型系统，并对MIPS、ARM、PPC等多种架构的网络服务程序进行了评估。通过与协议模糊器Boofuzz和Peach在边缘覆盖指标方面的比较，我们的原型系统分别获得了33.7%和38.4%的平均增长率。我们进一步验证了6个已知的漏洞，并利用Fw-fuzz发现了5个0天漏洞，证明了我们的框架的有效性和实用性。我们系统的开销表示为内存增长的额外5%。
{% endspoiler %}</p></li><li><p><a href=https://ieeexplore.ieee.org/iel7/6287639/8948470/08990098.pdf>FIRMCORN: Vulnerability-Oriented Fuzzing of IoT Firmware via Optimized Virtual Execution</a> (2020)
{% spoiler more %}
物联网(IoT)的安全形势尤为严峻，大量物联网设备容易出现漏洞。在本研究中，我们提出了第一个面向漏洞的物联网固件模糊器FIRMCORN。基于优化虚拟执行的新技术，FIRMCORN重点研究了物联网固件模糊化的三个典型问题:(1)模糊化需要高吞吐量;(2)仿真与真实设备相比不准确;(3)缺乏硬件导致的仿真不稳定。在这里，我们优化了虚拟执行的初始环境和执行过程，以实现更快、更准确、更稳定的模糊测试。为提高fircorn漏洞挖掘的效率，根据物联网固件的特点，设计了一种漏洞代码搜索算法，获取模糊化入口点;此外，这种面向漏洞的模糊处理应用于物联网设备固件。我们的评估结果表明，与传统虚拟执行相比，fircorn使用的优化虚拟执行可以显著提高吞吐量、准确性和稳定性。FIRMCORN只运行2小时，就能在一台机器上挖掘出两个0天的漏洞。因此，与目前最先进的物联网固件模糊化框架相比，FIRMCORN可以更有效地挖掘现实设备中的漏洞。
{% endspoiler %}</p></li><li><p><a href=https://dl.acm.org/doi/pdf/10.1145/3338507.3358616>FirmFuzz: Automated IoT Firmware Introspection and Analysis</a> (2019)
{% spoiler more %}
虽然物联网设备的数量以令人振奋的速度增长，但其安全性却停滞不前。在所有供应商之间强制执行安全编码标准是不可行的。测试单个设备可以让分析师评估其部署后的安全性。然后可以向供应商披露任何发现的漏洞，以帮助他们保护其产品。为了提高效率，理想情况下应该自动查找漏洞，而且为了提高可伸缩性，应该独立于设备。我们提出了一个用于基于linux的固件映像的自动化设备无关仿真和动态分析框架FirmFuzz。它使用基于灰盒的分代模糊方法，并结合静态分析和系统内省，在固件映像中提供有针对性的、确定性的bug发现。我们通过模拟和动态分析32个图像(来自27个独特的设备)来评估FirmFuzz，网络可从执行模拟的主机访问。在测试过程中，FirmFuzz在6个不同的设备上发现了7个之前未披露的漏洞:两个IP摄像头和4个路由器。到目前为止，已经分配了4个CVE。
{% endspoiler %}</p></li><li><p><a href=https://wcventure.github.io/FuzzingPaper/Paper/NDSS18_Muench_paper.pdf>What You Corrupt Is Not What You Crash: Challenges in Fuzzing Embedded Devices</a> (2018)
{% spoiler more %}
{% post_link &lsquo;paper-vfsf-2&rsquo; &lsquo;Note&rsquo; %}</p></li></ul><p>随着网络化嵌入式系统越来越普遍，其安全性对我们的日常生活变得至关重要。虽然对这些系统进行手动或自动化的大规模分析会定期发现新的漏洞，但分析这些系统的方法通常与桌面系统中使用的方法相同。更具体地说，传统的测试方法依赖于可观察到的程序崩溃，二进制检测技术用于改进对这些错误状态的检测。
在本文中，我们演示了内存损坏(一种常见的安全漏洞)在嵌入式设备上导致的行为通常与桌面系统不同。特别是，在嵌入式设备上，内存损坏的影响通常不太明显。这大大降低了传统动态测试技术的有效性，特别是模糊。
此外，我们分析了几类嵌入式设备中的这些差异，并展示了对固件分析的结果影响。我们进一步描述和评估可以在运行时(在执行跟踪或在模拟器中)应用的相对简单的启发式方法，在分析嵌入式设备时检测以前未检测到的内存损坏。
{% endspoiler %}</p><h3 id=real-device>Real Device<a hidden class=anchor aria-hidden=true href=#real-device>#</a></h3><ul><li><p><a href=http://www.es.mdh.se/pdf_publications/5186.pdf>A Runtime Verification Tool for Detecting Concurrency Bugs in FreeRTOS Embedded Software</a> (2018)
{% spoiler more %}
本文介绍了一种用于嵌入式软件在开源实时操作系统FreeRTOS下运行的运行时验证工具。该工具可以检测和诊断并发bug，如死锁、饥饿和基于挂起的锁。该工具在运行时发现并发错误，而不需要调试和跟踪源代码。该工具使用Tracealyzer工具记录相关事件。通过分析日志，我们的工具可以通过应用单独诊断每种并发性bug类型的算法来检测并发性bug。
在本文中，我们介绍了该工具的实现，以及它的功能架构，并说明了它的使用。该工具可以在程序测试期间使用，以获得关于嵌入式软件执行的有趣信息。我们展示了在AVR 32位板SAM4S上运行该工具的一些典型bug示例的初始结果。
{% endspoiler %}</p></li><li><p><a href=http://web.cse.ohio-state.edu/~zhao.2708/assets/ndss18/NDSS18.pdf>IoTFuzzer: Discovering Memory Corruptions in IoT Through App-based Fuzzing</a> (2018)
{% spoiler more %}
随着越来越多的物联网设备进入消费市场，在攻击者之前检测它们的安全漏洞变得势在必行。现有的基于二进制分析的方法只在固件上工作，这是比较难访问的，除非那些配备了从设备提取代码的特殊工具。为了解决物联网安全分析中的这一挑战，我们在本文中提出了一种新的自动模糊化框架，称为IOTFUZZER，旨在发现在无法访问其固件映像的物联网设备中的内存破坏漏洞。其关键思想是基于这样一种观察，即大多数物联网设备都是通过其官方移动应用程序控制的，而这样的应用程序通常包含有关其用于与设备通信的协议的丰富信息。因此，通过识别和重用特定于程序的逻辑(例如，加密)来改变测试用例(特别是消息字段)，我们能够有效地探测物联网目标，而无需依赖任何关于其协议规范的知识。在我们的研究中，我们实现了iotfuzzer，并评估了17个运行在不同协议上的真实IoT设备，我们的方法成功识别了15个内存破坏漏洞(包括8个之前未知的漏洞)。
{% endspoiler %}</p></li><li><p><a href=https://www.koreascience.or.kr/article/JAKO201326951843452.pdf>RPFuzzer: A Framework for Discovering Router Protocols Vulnerabilities Based on Fuzzing</a> (2013)
{% spoiler more %}
如何有效、自动地发现路由器漏洞是保障网络和信息安全的关键问题。以往对路由器安全的研究主要集中在利用路由器已知缺陷的技术上。Fuzzing是一种著名的自动化漏洞发现技术;然而，传统的Fuzzing工具是为测试网络应用或其他软件而设计的。这些工具不适合或部分不适合测试路由器。本文设计了一个发现路由器协议漏洞的框架，并在已有的测试用例生成方法的基础上，提出了一个两阶段模糊测试用例生成器(TFTCG)的数学模型。我们开发了一个基于TFTCG的RPFuzzer工具。RPFuzzer通过发送正常的数据包、监视CPU利用率和检查系统日志来监控路由器，这些日志可以检测到DoS、路由器重启等。基于修改的Dynamips的RPFuzzer&rsquo;调试器，它可以在发生异常时记录寄存器值。最后，我们在SNMP协议上进行实验，发现了8个漏洞，其中有5个未发布的漏洞。实验证明了该方法的有效性。
{% endspoiler %}</p></li></ul><h3 id=emulator>Emulator<a hidden class=anchor aria-hidden=true href=#emulator>#</a></h3><ul><li><a href=https://0xdkay.me/pub/2020/kim-acsac2020.pdf>FirmAE: Towards Large-Scale Emulation of IoT Firmware for Dynamic Analysis</a> (2020)
{% spoiler more %}
FIRMADYNE改良</li></ul><p>评估嵌入式物联网设备安全性的一种方法是对其固件进行动态分析，如模糊测试。为此，现有的方法旨在提供一个模拟真实硬件/外设行为的模拟环境。尽管如此，在实践中，这些方法只能模拟固件映像的一小部分。例如，我们从八大制造商那里收集到的1124张无线路由器/ ip摄像头图像中，最先进的工具Firmadyne只能显示183张(16.28%)。如此低的仿真成功率是由于真实的固件执行环境和仿真的固件执行环境不一致造成的。在本研究中，我们分析了大规模数据集中的模拟失败案例，以找出导致模拟率低的原因。我们发现，尽管根本原因不同，但使用简单的启发式方法往往可以避免广泛的故障情况，从而显著提高模拟的成功率。基于这些发现，我们提出了一种技术，仲裁模拟，并将几种启发式技术系统化，作为仲裁技术来解决这些故障。我们的自动化原型FirmAE成功地运行了1124个固件映像中的892个(79.36%)，其中包括web服务器，这比Firmadyne运行的映像多了很多(≈4.8倍)。最后，通过对仿真图像应用动态测试技术，FirmAE可以检测320个已知漏洞(比Firmadyne多306个)，并在23个设备中发现12个新的0天漏洞。
{% endspoiler %}</p><ul><li><a href=https://www.usenix.org/system/files/sec19-zheng_0.pdf>FIRM-AFL: high-throughput greybox fuzzing of iot firmware via augmented process emulation</a> (2019)
{% spoiler more %}
FIRMADYNE改良</li></ul><p>针对物联网设备的网络攻击是一个严重的威胁。这些攻击利用了物联网固件的软件漏洞。摸索是一种有效的软件测试技术，用于发现漏洞。在这项工作中，我们提出了FIRM-AFL，这是第一个用于物联网固件的高通量灰盒模糊器。FIRM-AFL解决了物联网模糊测试的两个基本问题。首先，它通过对POSIX兼容的固件进行模糊处理来解决兼容性问题，这些固件可以在系统仿真器中模拟。其次，它通过一种称为增强进程仿真的新技术解决了系统模式仿真造成的性能瓶颈问题。通过将系统模式仿真和用户模式仿真以一种新颖的方式结合起来，增强的进程仿真提供了系统模式仿真的高兼容性和用户模式仿真的高吞吐量。我们的评估结果显示：（1）FIRM-AFL功能齐全，能够发现物联网程序中的真实漏洞；（2）FIRM-AFL的吞吐量平均比基于系统模式仿真的模糊测试高8.2倍；（3）FIRM-AFL能够比基于系统模式仿真的模糊测试更快地发现1天的漏洞，并且能够发现0-day的漏洞。
{% endspoiler %}</p><ul><li><a href=https://www.ndss-symposium.org/wp-content/uploads/2017/09/towards-automated-dynamic-analysis-linux-based-embedded-firmware.pdf>Towards Automated Dynamic Analysis for Linux-based Embedded Firmware</a> (2016)
{% spoiler more %}
{% post_link &lsquo;paper-vfsf-3&rsquo; &lsquo;Note&rsquo; %}</li></ul><p>商用现货(COTS)网络支持的嵌入式设备通常由供应商固件控制，在我们的日常生活中执行不可或缺的功能。例如，家庭无线路由器通常是将家庭用户的个人计算和信息设备与互联网隔离开来的第一道也是唯一一道防线。在用户网络中这样一个至关重要的特权位置要求这些设备安全地运行。不幸的是，最近的研究和传闻证据表明，世界各地部署的设备根本不支持这种安全假设。
评估此类嵌入式设备固件安全性的第一步是准确识别漏洞。然而，市场提供了各种各样的嵌入式设备，这严重影响了该领域现有方法的可扩展性。在本文中，我们提出了FIRMADYNE，这是第一个自动化的动态分析系统，以可伸缩的方式专门针对网络连接COTS设备上基于linux的固件。我们确定了一系列固有于COTS固件动态分析的挑战，并讨论了我们的设计决策如何解决它们。在其核心，FIRMADYNE依赖于基于软件的完整系统模拟和一个仪表化内核，以实现自动分析数千个固件二进制文件所需的可伸缩性。
我们通过收集42家设备供应商的23,035个固件图像的真实数据集，对FIRMADYNE进行了评估。使用我们的系统可以成功提取的9486个固件映像上的74个漏洞样本，我们发现跨越至少89个不同产品的887个固件映像容易受到一个或多个采样漏洞的攻击。其中包括在我们的框架帮助下发现的14个以前未知的漏洞，这些漏洞影响至少12个不同产品的69个固件映像。此外，我们的结果显示，我们测试的11次攻击影响了来自多个供应商的固件映像，这表明代码共享和通用上游制造商(oem)非常普遍。
{% endspoiler %}</p><h3 id=hardware-in-the-loophitl>Hardware-in-the-loop（HITL）<a hidden class=anchor aria-hidden=true href=#hardware-in-the-loophitl>#</a></h3><ul><li><p><a href=https://www.eurecom.fr/publication/5437/download/sec-publi-5437.pdf>Avatar2: A Multi-target Orchestration Platform</a> (2018)
{% spoiler more %}
动态二进制分析技术在研究软件系统的安全性和检测广泛的设备和应用中的漏洞方面发挥着核心作用。在过去的十年中，已经发布了各种不同的技术，通常伴随着原型工具的发布来证明它们的有效性。不幸的是，这些技术的大多数实现都与它们的动态分析框架深度耦合，并且不容易集成到其他框架中。这些框架的设计目的不是向其他组件公开它们的内部状态或结果。这使得分析人员无法将不同的工具组合在一起，以利用它们的优势并解决需要复杂技术组合的复杂问题。碎片化和隔离是两个非常重要的问题，它们常常导致对同一问题的重复工作或多个等效解决方案——每个解决方案都基于不同的编程语言、抽象模型或执行环境。
在本文中，我们提出了avatar2，一个动态多目标编制框架，旨在实现不同动态二进制分析框架、调试器、模拟器和真实物理设备之间的互操作性。Avatar2允许分析师在复杂的拓扑结构中组织不同的工具，然后将二进制代码的执行从一个系统“移动”到另一个系统。该框架支持设备/应用程序内部状态的自动传输，以及对物理外设或模拟目标的输入/输出和内存访问的可配置转发。
为了演示avatar2的使用和通用性，在本文中，我们展示了三个非常不同的用例，其中我们复制了一个在NDSS 2017上展示的PLC rootkit，我们结合Angr和GDB测试Firefox，我们使用PANDA和OpenOCD记录嵌入式设备固件的执行情况。所有的工具和三个用例将作为开源发布，以帮助其他研究人员复制我们的实验，并使用avatar2执行他们自己的分析任务。
{% endspoiler %}</p></li><li><p><a href=https://www.usenix.org/system/files/conference/woot15/woot15-paper-koscher.pdf>SURROGATES: Enabling Near-Real-Time Dynamic Analyses of Embedded Systems</a> (2015)
{% spoiler more %}
嵌入式系统正变得越来越复杂、相互连接和普及。不幸的是，保护这些系统仍然具有挑战性。虽然已经为传统软件开发了强大的动态分析工具，但嵌入式系统的独特特性使这些众所周知的技术难以应用;以前的工作仅限于小系统或短代码段。在本文中，我们演示了一个系统，它能够在接近实时的情况下对嵌入式系统进行仿真和测量，使各种动态分析技术成为可能。我们的方法在主机的spci Express总线和被测系统之间使用一个定制的、低延迟的FPGA桥接器，允许模拟器完全访问系统的外设。这为模拟器提供了固件正常执行环境的真实表示，支持额外的动态分析技术，如concolic执行。我们讨论了设计决策和工程权衡，并根据之前的工作评估我们的系统。
{% endspoiler %}</p></li><li><p><a href="https://www.researchgate.net/profile/Jonas-Zaddach/publication/269197057_Avatar_A_Framework_to_Support_Dynamic_Security_Analysis_of_Embedded_Systems'_Firmwares/links/5e0b2725299bf10bc3852355/Avatar-A-Framework-to-Support-Dynamic-Security-Analysis-of-Embedded-Systems-Firmwares.pdf">AVATAR: A framework to support dynamic security analysis of embedded systems&rsquo; firmwares</a> (2014)
{% spoiler more %}
为了解决对嵌入式系统安全性日益增长的关注，对固件二进制文件进行准确的分析是很重要的，即使在源代码或硬件文档不可用的情况下。然而，由于缺乏专门的研究工具，这一领域的研究受到了阻碍。例如，动态分析是安全分析的主要基础之一，例如，通过动态污染跟踪或符号执行。与静态分析不同，动态分析依赖于在受控环境中执行软件的能力，通常是一个仪表化的模拟器。然而，模拟嵌入式设备的固件需要被分析的系统所使用的所有硬件组件的精确模型。不幸的是，缺乏文档和市场上各种各样的硬件使得这种方法在实践中不可行。
在这篇文章中，我们提出了Avatar，一个通过协调模拟器和真实硬件的执行来实现嵌入式设备复杂动态分析的框架。首先介绍了将I/O访问从模拟器转发到嵌入式设备的基本机制，然后描述了通过动态优化两种环境之间的代码和数据分布来提高系统性能的几种技术。最后，我们通过将其应用于三种不同的安全场景来评估我们的工具，包括反向工程、漏洞发现和硬编码后门检测。为了展示Avatar的灵活性，我们在三个完全不同的设备上进行分析:GSM功能手机、硬盘引导加载程序和无线传感器节点。
{% endspoiler %}</p></li></ul><h3 id=re-hosting>Re-hosting<a hidden class=anchor aria-hidden=true href=#re-hosting>#</a></h3><ul><li><a href=https://www.usenix.org/system/files/sec21fall-zhou.pdf>Automatic Firmware Emulation through Invalidity-guided Knowledge Inference</a> (2021)
{% spoiler more %}
<a href=https://mp.weixin.qq.com/s/ep-PHxwsi8wBxUofDnnsYQ>G.O.S.S.I.P 学术论文推荐 2022-01-19 uEmu</a></li></ul><p>由于硬件和固件之间的紧密耦合，对微控制器进行固件仿真具有挑战性。这极大地阻碍了动态分析工具在固件分析中的应用。最先进的工作是通过观察未知外设的访问模式来自动建模，然后利用启发式来计算当未知外设寄存器被访问时的适当响应。但是，我们根据经验发现，这种方法和相应的启发式方法通常不足以模拟固件。在这项工作中，我们提出了一种新的方法，称为μEmu来模拟固件与未知的外设。与试图为每个外设构建通用模型的现有工作不同，我们的方法学习如何正确地模拟在各个外设访问点上的固件执行。它将图像作为输入，并通过将未知的外围寄存器表示为符号来象征性地执行它。在符号执行期间，它推断出响应未知外设访问的规则。这些规则存储在一个知识库中，在动态固件分析期间将引用该知识库。μEmu在外设驱动程序单元测试中，在没有任何人工辅助的情况下，达到93%的通过率。我们还用真实的固件样本评估μEmu，发现了新的bug。
{% endspoiler %}</p><ul><li><p><a href=https://www4.comp.polyu.edu.hk/~csxluo/FirmGuide.pdf>FirmGuide: Boosting the Capability of Rehosting Embedded Linux Kernels through Model-Guided Kernel Execution</a> (2021)
{% spoiler more %}
Linux内核广泛应用于嵌入式系统中。为了理解对Linux内核的实际威胁，我们需要使用全系统模拟器(例如QEMU)执行动态分析。然而，由于硬件碎片化，例如各种类型的外设，QEMU目前不支持大多数嵌入式系统。虽然在重新托管固件方面取得了一些进展，但它主要集中在用户空间程序或简单的实时操作系统上。这项工作的目标是提高在QEMU中重新托管嵌入式Linux内核的能力。这样，通过利用QEMU上现成的工具，动态分析系统就可以首先应用于嵌入式Linux内核。因此，我们提出了一种称为模型引导内核执行的新技术。它结合了Linux内核中的外围设备抽象和内核-外围设备交互，以半自动生成外围设备模型，然后用这些模型合成新的QEMU虚拟机来启动动态分析。我们实现了一个名为FirmGuide的原型。它生成了9个功能完整的外围设备型号和64个最小功能覆盖26个soc。我们对6188个固件镜像的评估表明，它可以成功地在2个架构和22个版本中重新托管95%以上的Linux内核。它们都不能在普通的QEMU中重新托管。LTP基准测试的结果显示了重新托管的Linux内核的可靠性和健壮性。我们进一步在重新托管的Linux内核上执行两个安全应用程序，即漏洞分析和模糊处理，以演示使用场景。
{% endspoiler %}</p></li><li><p><a href=https://www.usenix.org/system/files/sec20-clements.pdf>HALucinator: Firmware Re-hosting Through Abstraction Layer Emulation</a> (2020)
{% spoiler more %}
考虑到在线嵌入式设备的日益普及，分析其固件对安全性、隐私性和安全性非常重要。硬件和固件之间的紧密耦合以及嵌入式系统的多样性使固件难以进行动态分析。然而，固件开发人员经常使用抽象来开发代码，例如硬件抽象层(HALs)，以简化他们的工作。我们利用这些抽象作为重新托管和分析固件的基础。通过提供HAL功能的高级替换(称为高级仿真- HLE的过程)，我们将硬件与固件解耦。这种方法首先通过二进制分析定位固件示例中的库函数，然后在整个系统模拟器中提供这些函数的一般实现。
我们在一个原型系统HALucinator中提出了这些想法，该系统能够重新托管固件，并允许虚拟设备正常使用。首先，我们引入了对现有库匹配技术的扩展，这些技术需要在二进制固件中识别库函数，以减少冲突，并推断额外的函数名。接下来，我们将通过使用简化的处理程序和外围设备模型来演示重新托管过程，这将使该过程在固件样本和芯片供应商之间快速、灵活和可移植。最后，通过对HALucinator和美国Fuzzy Lop fuzzer进行补充，我们证明了HLE用于安全分析的实用性，以定位固件中间件库中先前未知的多个漏洞。
{% endspoiler %}</p></li><li><p><a href=https://dl.acm.org/doi/pdf/10.1145/3427228.3427280>Device-agnostic Firmware Execution is Possible: A Concolic Execution Approach for Peripheral Emulation</a> (2020)
{% spoiler more %}
随着物联网设备的迅速普及，我们的网络空间如今由数十亿低成本的计算节点主导，这些节点彼此之间非常异构。动态分析是发现软件bug的最有效的方法之一，但由于缺乏能够运行各种以前看不到的固件的通用模拟器，动态分析已经陷入瘫痪。近年来，我们目睹了针对基于微控制器的低端物联网设备的破坏性安全漏洞。这些安全问题严重阻碍了物联网技术的进一步发展。在这项工作中，我们提出了Laelaps，一个专门设计的设备模拟器，以运行各种软件的微控制器设备。我们不会将任何关于设备的特定信息编码到模拟器中。相反，Laelaps通过符号执行辅助的外围模拟来推断固件的预期行为，并生成适当的输入来实时控制具体的执行。这种独特的设计特性使Laelaps能够运行不同的固件，而无需预先了解目标设备。为了演示Laelaps的功能，我们在模拟器上应用了动态分析技术。我们成功地识别了自我注入的和现实世界的漏洞。
{% endspoiler %}</p></li><li><p><a href=https://arxiv.org/pdf/2007.01502>DICE: Automatic Emulation of DMA Input Channels for Dynamic Firmware Analysis</a> (2020)
{% spoiler more %}
基于微控制器的嵌入式设备是物联网(IoT)和信息物理系统(CPS)的核心。这些设备的安全至关重要。在保护嵌入式设备安全的方法中，动态固件分析(例如漏洞检测)由于其脱机特性和较低的假阳性率，最近受到了极大的关注。然而，无论使用何种分析和仿真技术，现有的动态固件分析器都有一个主要的限制，即无法使用DMA(直接内存访问)处理固件。它严重限制了支持的设备类型和固件代码覆盖范围。
我们提出了DICE，一种用于固件分析器模拟DMA输入通道和生成或操作DMA输入(从外设到固件)的临时解决方案。DICE被设计为独立于硬件(即不需要实际的外设或DMA控制器)，并兼容常见的MCU固件(即不假设特定于固件的DMA使用)和嵌入式架构。DICE背后的高级思想是识别和模拟抽象的DMA输入通道，而不是高度多样化的外围设备和控制器。当固件将源DMA传输指针和目标DMA传输指针写入DMA控制器时，DICE识别DMA输入通道。然后，DICE代表固件分析器操作通过DMA传输的输入。DICE不需要固件源代码或固件分析器提供的其他功能。
我们将DICE集成到最近提出的固件分析器P2IM(用于ARM Cortex-M架构)和PIC32模拟器(用于MIPS M4K/M-Class架构)。我们在83个基准测试和样本固件上评估了它，代表了来自5个不同供应商的9个不同的DMA控制器。DICE检测到37个DMA输入通道中的33个，0个假阳性。它正确地为固件实际使用的22个DMA缓冲区中的21个提供了DMA输入，这是由于缺乏DMA模拟，以前的固件分析器无法实现的。DICE的开销相当低，它平均增加了3.4%的P2IM执行时间。我们还使用DICE对7个真实世界的固件进行了模糊测试，并将结果与原始P2IM进行了比较。DICE发现了更多的执行路径(多达79X)，并发现了5个以前不知道的独特bug，这些bug在没有DMA模拟的情况下无法访问。我们所有的源代码和数据集都是公开的。
{% endspoiler %}</p></li><li><p><a href=https://www.usenix.org/system/files/sec20-feng.pdf>P2IM: Scalable and Hardware-independent Firmware Testing via Automatic Peripheral Interface Modeling</a>(2020)
{% spoiler more %}
嵌入式固件的动态测试或模糊严重限制了硬件依赖和较差的可伸缩性，部分导致了普遍存在的脆弱的物联网设备。我们提出了一种软件框架，它可以持续地执行给定的固件二进制文件，同时从现成的模糊器引导输入，从而支持独立于硬件的、可扩展的固件测试。我们的框架使用了一种名为P2IM的新技术，对各种外设进行抽象，并根据自动生成的模型动态地处理固件I/O。P2IM与外围设备设计无关，与固件实现通用，因此适用于广泛的嵌入式设备。我们使用70个样本固件和10个来自真实设备(包括无人机、机器人和PLC)的固件来评估我们的框架。在没有任何人工协助的情况下，它成功地执行了79%的样本固件。我们还对真实的固件进行了有限的模糊测试，发现了7个独特的未知bug。
{% endspoiler %}</p></li><li><p><a href=https://www.usenix.org/system/files/raid2019-gustafson.pdf>Toward the Analysis of Embedded Firmware through Automated Re-hosting</a> (2019)
{% spoiler more %}
最近物联网(IoT)带来的范式转变使嵌入式系统成为安全分析师和恶意对手的目标。物联网设备缺乏标准化的硬件、多样化的软件和不透明的功能，由于其固件和设计的硬件之间的紧密耦合，给安全分析师带来了独特的挑战。为了利用现代程序分析技术，如模糊或符号执行，以任何类型的规模或深度，分析人员必须有能力在模拟(或虚拟化)环境中执行固件代码。然而，这些仿真环境很少可用，并且通过手动反向工程创建起来很麻烦，这极大地限制了二进制固件的分析。在本文中，我们探讨了固件重新托管的问题，即固件从其原始硬件环境迁移到虚拟化环境的过程。我们展示了一种能够以自动化方式创建虚拟交互环境的方法，这是实现大规模固件分析的必要条件。我们提出了旨在实现这一目标的第一个概念验证系统，称为PRETENDER，它使用对原始硬件和固件之间交互的观察来自动创建外设的模型，并允许在完全模拟的环境中执行固件。与以前的方法不同，这些模型是交互式的、有状态的和可转移的，这意味着它们被设计为允许程序接收和处理新的输入，这是许多分析的需求。我们在多个硬件平台和固件示例上演示了我们的方法，并展示了模型足够灵活，以允许虚拟化代码执行、探索新的代码路径和识别安全漏洞。
{% endspoiler %}</p></li></ul><h3 id=static-analysis>Static Analysis<a hidden class=anchor aria-hidden=true href=#static-analysis>#</a></h3><ul><li><p><a href=https://escholarship.org/content/qt53p09210/qt53p09210.pdf>Karonte: Detecting Insecure Multi-binary Interactions in Embedded Firmware</a> (2020)
{% spoiler more %}
低功耗、单一用途的嵌入式设备（例如路由器和物联网设备）已经无处不在。虽然它们自动化并简化了用户生活的许多方面，但最近的大规模攻击表明，它们的数量对互联网基础设施构成了严重威胁。不幸的是，这些系统上的软件依赖于硬件，并且通常在具有非标准配置的独特、最小环境中执行，这使得安全分析特别具有挑战性。许多现有设备通过使用多个二进制文件来实现其功能。这种多二进制服务实现使当前的静态和动态分析技术无效或低效，因为它们无法识别和充分建模各种可执行文件之间的通信。在本文中，我们介绍了 KARONTE，这是一种静态分析方法，能够通过建模和跟踪多二进制交互来分析嵌入式设备固件。我们的方法在二进制文件之间传播污染信息以检测不安全的交互并识别漏洞。我们首先在来自不同供应商的 53 个固件样本上评估了 KARONTE，表明我们的原型工具可以成功地跟踪和约束多二进制交互。这导致发现了 46 个零日漏洞。然后，我们对 899 个不同的样本进行了大规模实验，表明 KARONTE 可以很好地适应不同大小和复杂性的固件样本。
{% endspoiler %}</p></li><li><p><a href=https://www.ndss-symposium.org/wp-content/uploads/2017/09/11_1_2.pdf>Firmalice - Automatic Detection of Authentication Bypass Vulnerabilities in Binary Firmware</a> (2015)
{% spoiler more %}
嵌入式设备已经无处不在，它们被用于一系列隐私敏感和安全关键的应用程序中。这些设备中的大多数都运行专有软件，几乎没有关于软件内部工作的文档。在某些情况下，硬件和保护机制的成本可能会使访问设备本身变得不可行。如果必须避免与软件错误和漏洞相关的风险，则分析此类环境中存在的软件具有挑战性，但也是必要的。事实上，最近的研究表明，市场上的许多嵌入式设备都存在后门。在本文中，我们介绍了 Firmalice，这是一个二进制分析框架，用于支持分析在嵌入式设备上运行的固件。 Firmalice 建立在符号执行引擎和程序切片等技术之上，以提高其可扩展性。此外，Firmalice 利用一种新颖的身份验证绕过漏洞模型，基于攻击者确定执行特权操作所需输入的能力。我们在三个市售设备的固件上评估了 Firmalice，并且能够在其中两个设备中检测到身份验证绕过后门。此外，Firmalice 能够确定第三个固件样本中的后门不能被攻击者在不知道一组非特权凭证的情况下利用。
{% endspoiler %}</p></li></ul><h3 id=general-symoblic-execution>General Symoblic Execution<a hidden class=anchor aria-hidden=true href=#general-symoblic-execution>#</a></h3><ul><li><a href=http://193.55.114.4/docs/ndss21_symqemu.pdf>SymQEMU:Compilation-based symbolic execution for binaries</a> (2021)
{% spoiler more %}
<a href="https://mp.weixin.qq.com/s?__biz=MzA5ODA0NDE2MA==&amp;mid=2649774557&amp;idx=1&amp;sn=fda94410040b518fc0baa3e373de1b71&amp;chksm=889369b2bfe4e0a4d2a9d0c583ea9ab1f45ac637d450b0b966afdbfcf902bffdfffe2efd8d61&amp;scene=27">带你搞懂符号执行的前世今生与最近技术</a></li></ul><p>符号执行是一种强大的软件分析和错误检测技术。基于编译的符号执行是最近提出的一种风格，已被证明可以在源代码可用时显着提高符号执行的性能。我们展示了一种新技术，可以实现基于编译的二进制符号执行（即，无需源代码）。我们的系统 SymQEMU 构建在 QEMU 之上，在将目标程序转换为主机架构之前修改目标程序的中间表示。这使 SymQEMU 能够将符号执行功能编译到二进制文件中，并在保持架构独立性的同时获得相关的性能优势。
我们展示了我们的方法和实现，并证明它在统计上优于最先进的二进制符号执行器 S2E 和 QSYM；在某些基准测试中，它甚至比基于源代码的 SymCC 获得了更好的性能。此外，我们的工具在经过良好测试的 libarchive 库中发现了一个以前未知的漏洞，证明了它在测试真实世界软件中的实用性。
{% endspoiler %}</p><ul><li><p><a href=https://www.eurecom.fr/publication/6000/download/sec-publi-6000.pdf>Systematic Comparison of Symbolic Execution Systems: Intermediate Representation and its Generation</a> (2019)
{% spoiler more %}
符号执行已成为一种流行的软件测试和漏洞检测技术。大多数实现将正在分析的程序转换为某种中间表示 (IR)，然后将其用作符号执行的基础。有大量可用的 IR，甚至还有更多方法可以将目标程序转换为相应的 IR。
在开发符号执行引擎时，需要选择一个 IR，但不清楚 IR 生成过程对生成的系统有何影响。从源代码生成 IR 与提升机器代码的符号执行各自有什么好处？区别甚至重要吗？不使用 IR，直接执行机器代码有什么影响？我们认为几乎没有科学证据支持这些问题的答案。因此，我们首先开发了一种系统比较符号执行的不同方法的方法；然后，我们用它来评估选择 IR 和 IR 生成的影响。我们将我们的比较框架提供给社区以供未来研究。
{% endspoiler %}</p></li><li><p><a href=https://arxiv.org/pdf/1610.00502>A Survey of Symbolic Execution Techniques</a> (2016)
{% spoiler more %}
许多安全和软件测试应用程序需要检查程序的某些属性是否适用于任何可能的使用场景。例如，用于识别软件漏洞的工具可能需要排除任何后门的存在以绕过程序的身份验证。一种方法是使用不同的、可能是随机的输入来测试程序。由于后门可能只针对非常特定的程序工作负载而受到攻击，因此对可能输入空间的自动探索至关重要。符号执行通过系统地同时探索许多可能的执行路径而不必需要具体的输入，为该问题提供了一个优雅的解决方案。该技术不是采用完全指定的输入值，而是将它们抽象地表示为符号，诉诸约束求解器来构造可能导致属性违规的实际实例。符号执行在过去 4 年中开发的数十种工具中得到了孵化，在许多著名的软件可靠性应用程序中取得了重大的实际突破。本次调查的目的是概述该领域开发的主要想法、挑战和解决方案，并将其提炼给广大受众。
{% endspoiler %}</p></li><li><p><a href=https://re.public.polimi.it/bitstream/11311/1161277/1/sok-the-art-of-war-offensive-techniques-in-binary-analysis-oakland2016.pdf>(State of) The Art of War: Offensive Techniques in Binary Analysis</a> (2016)
{% spoiler more %}
寻找和利用二进制代码中的漏洞是一项具有挑战性的任务。缺乏有关数据结构和控制结构的高层次、语义丰富的信息使得对程序属性的分析难以扩展。然而，二元分析的重要性正在上升。在许多情况下，二进制分析是唯一可能证明(或否定)实际执行的代码属性的方法。
在本文中，我们提出了一个二元分析框架，它实现了过去提出的许多分析技术。我们提出了这些技术的系统化实现，这允许其他研究人员组合他们，并开发新的方法。此外，在统一的框架中实现这些技术允许对这些方法进行直接比较，并确定它们的优点和缺点。本文所包含的评估是使用DARPA创建的用于评估二进制漏洞分析技术有效性的最新数据集进行的。
我们的框架是开源的，安全社区可以使用。
{% endspoiler %}</p></li></ul><h3 id=vehicle>Vehicle<a hidden class=anchor aria-hidden=true href=#vehicle>#</a></h3><ul><li><a href=https://ieeexplore.ieee.org/abstract/document/9296745>Cyber–Physical Security of Powertrain Systems in Modern Electric Vehicles: Vulnerabilities, Challenges, and Future Visions</a> (2021)
{% spoiler more %}
{% post_link &lsquo;paper-vfsf-7&rsquo; &lsquo;Note&rsquo; %}</li></ul><p>由于电力电子系统在物联网(IoT)应用领域(包括联网电动汽车)的日益普及，它们越来越容易受到网络物理威胁。为了响应这一新兴需求，IEEE电力电子学会(peles)最近发起了一项网络物理安全倡议。随着V2X (vehicle-to-everything)和电子控制单元数量的增加，联网电动汽车面临着更大的网络物理安全挑战。然而，现有的研究主要集中在内燃机汽车的网络安全方面，并没有具体解决电动汽车的网络物理安全问题。本文从固件安全、车辆充电安全、动力系统控制安全等方面探讨了联网电动汽车网络物理安全面临的挑战和未来前景。在各种网络攻击下，电动汽车的漏洞被调查，从能源效率驱动的攻击到安全驱动的攻击。仿真结果包括硬件在环(HIL)结果，进一步分析了网络攻击对转换器(设备)和车辆(系统)级别的影响。更重要的是，下一代电力电子系统的架构被提出，以解决电动汽车的网络物理安全挑战。最后，详细讨论了潜在的研究机会，包括针对固件安全性的检测和迁移、基于模型和数据驱动的检测和缓解。据我们所知，这是首次对现代电动汽车动力系统的网络物理安全进行全面研究。
{% endspoiler %}</p><ul><li><a href=https://arxiv.org/pdf/1810.04144.pdf>A Brief Survey on Autonomous Vehicle Possible Attacks,Exploits and Vulnerabilities</a> (2021)
{% spoiler more %}
{% post_link &lsquo;paper-vfsf-8&rsquo; &lsquo;Note&rsquo; %}</li></ul><p>先进的驾驶辅助系统正在快速发展，各大企业都开始投资开发自动驾驶汽车。但安全性和可靠性仍然是不确定和有争议的。想象一下，一辆车被攻击者破坏了，然后他们能做什么。攻击者可以控制刹车，加速，甚至转向，这可以导致灾难性的后果。本文简要概述了自动驾驶汽车软件和硬件可能受到的大多数攻击及其潜在影响。
{% endspoiler %}</p><ul><li><a href=https://ieeexplore.ieee.org/abstract/document/8950902>Research on Detection and Evaluation Technology of Cybersecurity in Intelligent and Connected Vehicle</a> (2019)
{% spoiler more %}
{% post_link &lsquo;paper-vfsf-6&rsquo; &lsquo;Note&rsquo; %}</li></ul><p>随着汽车智能化和网络互联的不断发展，智能联网汽车(ICV)的网络安全问题日益突出。但目前汽车行业缺乏软件测试工具，缺乏网络安全检测与评估是亟待解决的严重问题。本文针对这一问题，开展了ICV检测评估平台的研究，并对ICV网络安全检测技术进行了探索。此外，我们建立汽车网络安全漏洞数据库提供数据支撑，利用源代码分析、固件反向、渗透测试、仿真等检测技术，对汽车终端、数据通信、云平台、APP等进行网络安全评估。设计全检测和风险评估，构建ICV安全检测评估平台。
{% endspoiler %}</p><h3 id=other>Other<a hidden class=anchor aria-hidden=true href=#other>#</a></h3><h2 id=reference>Reference<a hidden class=anchor aria-hidden=true href=#reference>#</a></h2><ul><li><a href=https://wcventure.github.io/FuzzingPaper/>Recent Papers Related To Fuzzing</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://eveneko.com/tags/firmware/>Firmware</a></li><li><a href=https://eveneko.com/tags/paper/>Paper</a></li></ul><nav class=paginav><a class=prev href=https://eveneko.com/posts/algorithm-tutorial/segemnt-tree/><span class=title>« 上一页</span><br><span>线段树(Segment Tree)入门</span>
</a><a class=next href=https://eveneko.com/posts/fcpx-tutorial/><span class=title>下一页 »</span><br><span>Fcpx 入门</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://eveneko.com>Neko Nest</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="复制";function s(){t.innerHTML="已复制！",setTimeout(()=>{t.innerHTML="复制"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>