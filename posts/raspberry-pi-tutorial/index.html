<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Raspberry Pi 指北 | Neko Nest</title>
<meta name=keywords content="Raspberry Pi"><meta name=description content="女朋友送的礼物，当然要好好折腾折腾 引言 树莓派到如今已经发布了4代，性能自然是越来越强了，每一代都分为A、B型，也有比较特殊的型号比如去掉大部分接口很小巧的树莓派Zero、去掉所有接口的树莓派计算型CM（Compute Module）、B型的增强型B+等。其中B型是最常用的，而A、B"><meta name=author content="Eveneko"><link rel=canonical href=https://eveneko.com/posts/raspberry-pi-tutorial/><link crossorigin=anonymous href=/assets/css/stylesheet.3613efbd0b1772781e8f49935e973cae632a7f61471c05b17be155505ccf87b5.css integrity="sha256-NhPvvQsXcngej0mTXpc8rmMqf2FHHAWxe+FVUFzPh7U=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://eveneko.com/images/logo.svg><link rel=icon type=image/png sizes=16x16 href=https://eveneko.com/images/logo.svg><link rel=icon type=image/png sizes=32x32 href=https://eveneko.com/images/logo.svg><link rel=apple-touch-icon href=https://eveneko.com/images/logo.svg><link rel=mask-icon href=https://eveneko.com/images/logo.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Raspberry Pi 指北"><meta property="og:description" content="女朋友送的礼物，当然要好好折腾折腾 引言 树莓派到如今已经发布了4代，性能自然是越来越强了，每一代都分为A、B型，也有比较特殊的型号比如去掉大部分接口很小巧的树莓派Zero、去掉所有接口的树莓派计算型CM（Compute Module）、B型的增强型B+等。其中B型是最常用的，而A、B"><meta property="og:type" content="article"><meta property="og:url" content="https://eveneko.com/posts/raspberry-pi-tutorial/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-01-09T19:50:35+08:00"><meta property="article:modified_time" content="2022-01-09T19:50:35+08:00"><meta property="og:site_name" content="Neko Nest"><meta name=twitter:card content="summary"><meta name=twitter:title content="Raspberry Pi 指北"><meta name=twitter:description content="女朋友送的礼物，当然要好好折腾折腾 引言 树莓派到如今已经发布了4代，性能自然是越来越强了，每一代都分为A、B型，也有比较特殊的型号比如去掉大部分接口很小巧的树莓派Zero、去掉所有接口的树莓派计算型CM（Compute Module）、B型的增强型B+等。其中B型是最常用的，而A、B"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://eveneko.com/posts/"},{"@type":"ListItem","position":3,"name":"Raspberry Pi 指北","item":"https://eveneko.com/posts/raspberry-pi-tutorial/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Raspberry Pi 指北","name":"Raspberry Pi 指北","description":"女朋友送的礼物，当然要好好折腾折腾 引言 树莓派到如今已经发布了4代，性能自然是越来越强了，每一代都分为A、B型，也有比较特殊的型号比如去掉大部分接口很小巧的树莓派Zero、去掉所有接口的树莓派计算型CM（Compute Module）、B型的增强型B+等。其中B型是最常用的，而A、B","keywords":["Raspberry Pi"],"articleBody":"女朋友送的礼物，当然要好好折腾折腾\n引言 树莓派到如今已经发布了4代，性能自然是越来越强了，每一代都分为A、B型，也有比较特殊的型号比如去掉大部分接口很小巧的树莓派Zero、去掉所有接口的树莓派计算型CM（Compute Module）、B型的增强型B+等。其中B型是最常用的，而A、B型区别也只在于尺寸和接口不同，SoC基本都是一致的。\n设备 MacBook Pro (14-inch, 2021) Raspberry Pi Model B (4GB) 硬件 主要接口 GPIO 引脚 散热器 风扇的接线是接载树莓派最外排是从右往左数第二和第三个引脚上，红色接第二根引脚（+5V），黑色接第三根引脚（GND）。\n搭建系统 树莓派开发板没有配置板载 FLASH，它支持 SD 卡启动（或者从U盘启动），所以我们需要下载相应镜像，并将其烧写在 SD 上制作系统盘。\n支持的系统如下： Raspbian、Arch Linux ARM、Debian Squeeze、Firefox OS、Gentoo Linux、Google Chrome OS、Raspberry Pi Fedora Remix、Slackware ARM、QtonPi、Slackware ARM、WebOS、RISC OS、FreeBSD、NetBSD、Android 4.0(Ice Cream Sandwich)\n下载镜像 https://www.raspberrypi.com/software/operating-systems/\n建议 NOOBS 安装。Mac用户直接可以跳过。\n镜像烧写 准备工作 TF卡（2GB以上） 读卡器 Raspberry Pi Imager（Mac烧录工具） Tips\n4b没有标准HDMI接口，只有micro HDMI接口 建议准备一根网线，直连在路由器上，这样方便获得树莓派ip地址 默认树莓派没有开启ssh，vnc服务，所以在无法连接显示屏的情况下，建议下载已经修改过设置的镜像 树莓派访问方式 外接 HDMI 或者 AV 显示器，USB 鼠标、键盘\n初次连接使用 使用 USB 转 TTL 串口模块通过串口访问树莓派\nSSH\nusername: pi password: raspberry VNC\n运营商普遍屏蔽了5900这个端口，注意转发\n树莓派配置 经过前面的步骤，树莓派已经可以正常工作了，但在正式开发使用之前，还需要做一些配置。\n树莓派第一次使用的时候需要进行一个简单的配置，在命令行模式下运行以下命令：\n1 sudo raspi-config System Options Wireless LAN 无线设置 Password 修改密码 Interface Options SSH 开启SSH VNC 开启VNC Localisation Options Lacale 建议英文 Timezone 初始为英国，这里改成 Shanghai/Hong Kong Overclock 超频选项，新手不建议调整 树莓派网络与更新配置 有线网络 自动获取 IP：树莓派默认有线网卡是使能的，只需将网线插入树莓派网卡，即可自动获得 IP(要求在局域网内)。 手动设定 IP：如果是电脑与树莓派直连，不能自动获得 IP，可以使用：ifconfig eth0 192.168.1.123 设定 ip(下次重启就没了)。 设置静态 IP：如果担心在同网络情况下 ip 或者不固定，可以讲电脑设置为静态 ip 打开文件 /etc/dhcpcd.conf 修改 # Example static IP configuration 下面的配置 无线网络 4b带有WiFi模块，所以可以直接跳过。\n更新软件源 Linux的软件不像Windows，基本都是需要在线安装的，但是树莓派由于各种原因其默认的软件源在国内速度并不是很理想，所以需要更新一下软件源。\n软件更新源\n1 sudo vi /etc/apt/sources.list 系统更新源\n1 sudo vi /etc/apt/sources.list.d/raspi.list 这里我们使用 清华源 ，根据自己机器操作系统的版本修改文件内容。\n查看系统版本\n1 lsb_release -a 1 2 3 4 5 No LSB modules are available. Distributor ID:\tRaspbian Description:\tRaspbian GNU/Linux 10 (buster) Release:\t10 Codename:\tbuster 挂载 使用fdisk命令查看设备硬盘情况\n1 sudo fdisk -l 使用 df 查看挂载情况\n1 df -h 手动挂载 在 /mnt 下新建一个目录作为挂载点\n1 sudo mkdir /mnt/udisk 挂载\n1 sudo mount -o uid=pi,gid=pi /dev/sda1 /mnt/udisk 卸载\n1 sudo umount /mnt/1GB_USB_flash Tips\nsda1 是取决于你的实际情况，a 表示第一个硬盘，1 表示第一个分区。 FAT 格式 U 盘 mount 本身就能支持，但如果你的 U 盘或移动硬盘使用的是 exFAT 格式，mount 会说不支持。 安装 exfat-fuse 软件之后 mount 就支持了。 sudo apt-get install exfat-fuse 开机挂载 在 /etc/fstab 中新增一行，每次开机都会挂载\n1 /dev/sda1 /mnt/udisk vfat rw,defaults 0 0 热插挂载 需要希望想电脑一样，插上自动识别挂载在某一目录下，拔下自动 umount，按以下操作，会自动在 /mnt/udisk 目录下挂载 U 盘。\n新建文件\n1 sudo vi /etc/udev/rules.d/10-usbstorage.rules 输入\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 KERNEL!=\"sd*\", GOTO=\"media_by_label_auto_mount_end\" SUBSYSTEM!=\"block\",GOTO=\"media_by_label_auto_mount_end\" IMPORT{program}=\"/sbin/blkid -o udev -p %N\" ENV{ID_FS_TYPE}==\"\", GOTO=\"media_by_label_auto_mount_end\" ENV{ID_FS_LABEL}!=\"\", ENV{dir_name}=\"%E{ID_FS_LABEL}\" ENV{ID_FS_LABEL}==\"\", ENV{dir_name}=\"Untitled-%k\" ACTION==\"add\", ENV{mount_options}=\"relatime,sync\" ACTION==\"add\", ENV{ID_FS_TYPE}==\"vfat\", ENV{mount_options}=\"iocharset=utf8,umaskk =000\" ACTION==\"add\", ENV{ID_FS_TYPE}==\"ntfs\", ENV{mount_options}=\"iocharset=utf8,umaskk =000\" ACTION==\"add\", RUN+=\"/bin/mkdir -p /mnt/udisk/\", RUN+=\"/bin/mount -o $env{mount__ options} /dev/%k /mnt/udisk/\" ACTION==\"remove\", ENV{dir_name}!=\"\", RUN+=\"/bin/umount -l /mnt/udisk/}\", RUN+=\"// bin/rmdir /mnt/udisk/\" LABEL=\"media_by_label_auto_mount_end\" 4b上不需要这个功能，默认挂在 /media/pi/\n墨水屏 1 2 3 4 5 6 7 8 9 10 == Hardware connection == EPD =\u003e Raspberry Pi * VCC -\u003e 3.3 * GND -\u003e GND * DIN -\u003e MOSI * CLK -\u003e SCLK * CS -\u003e 24 (Physical, BCM: CE0, 8) * D/C -\u003e 22 (Physical, BCM: 25) * RES -\u003e 11 (Physical, BCM: 17) * BUSY -\u003e 18 (Physical, BCM: 24) 软件 统计端口 application local port url smb 139,445 mysql 3306 calendar 5000 calendar.pi.eveneko.com:9000 vnc 5900 pi.eveneko.com:5901 pihole_web 8488 clash_web 8588 clash.pi.eveneko.com:9000 clash 7890,9090 nextcloud 8688 aria2 6800 ariaNg 8788 aria2.pi.eveneko.com:9000 frp dashboard 7500 pi.eveneko.com:7500 jupyter 8888 jupyter.pi.eveneko.com:9000 portainer 8988 portainer.pi.eveneko.com:9000 中文 安装中文字库\n1 sudo apt-get install ttf-wqy-zenhei 安装中文输入法\n1 sudo apt-get install fcitx fcitx-googlepinyin fcitx-module-cloudpinyin fcitx-sunpinyin python3 默认使用python3\n1 2 sudo rm /usr/bin/python sudo ln -s /usr/bin/python3.7 /usr/bin/python 换源\n临时使用\n1 pip install -i https://pypi.tuna.tsinghua.edu.cn/simple some-package 设为默认\n1 2 pip3 config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simple pip3 install pip -U nginx 安装\n1 sudo apt-get install nginx 其他命令\n1 2 3 4 5 6 # 启动 nginx systemctl start nginx # 停止 systemctl stop nginx # 加载配置文件 systemctl reload nginx 启动\n1 systemctl enable nginx jupyterlab 安装\n1 pip3 install jupyter 配置\n1 python3 -m jupyter notebook --generate-config 修改以下内容\n1 2 3 4 5 6 7 8 c.NotebookApp.allow_origin = '*' c.NotebookApp.ip = '0.0.0.0' c.NotebookApp.open_browser = False c.NotebookApp.port = 8888 c.NotebookApp.notebook_dir = '' c.NotebookApp.allow_root = True c.NotebookApp.allow_remote_access = True c.NotebookApp.token = '' 开机自启动\n在 /etc/init.d 下新建文件 jupyter.init\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 #!/bin/bash ### BEGIN INIT INFO # Provides: jupyter # Required-Start: $local_fs $remote_fs $network $syslog # Required-Stop: $local_fs $remote_fs $network $syslog # Default-Start: 2 3 4 5 # Default-Stop: 0 1 6 # Short-Description: jupyter service # Description: jupyter service daemon ### END INIT INFO case \"$1\" in start) echo \"starting jupyterlab\" su pi -c \"nohub python3 -m jupyterlab \u003e /dev/null 2\u003e\u00261 \u0026\" ;; stop) echo \"stopping jupyterlab\" kill $(ps aux|grep -m 1 'python3 -m jupyterlab'|awk '{ print $2}') ;; *) echo \"Usage: service jupyterlab start|stop\" exit 1 ;; esac exit 0 添加权限\n1 sudo chmod +x /etc/init.d/jupyter.init 设置开机启动\n1 sudo update-rc.d jupyter.init defaults 重启\nrcconf 查看启动项\n开机启动目前用supervisor实现，还可以守护进程。\nfrp内网穿透 frp 是一个高性能的反向代理应用，可以帮助您轻松地进行内网穿透，对外网提供服务，支持 tcp, http, https 等协议类型，并且 web 服务支持根据域名进行路由转发。\n在 frp releases 下载对应版本的frp\n下载后，对应修改 frps.ini\n服务端\n1 2 3 4 5 6 7 8 9 [common] bbind_port = 7000 privilege_token = eveneko max_pool_count = 5 dashboard_port = 7500 dashboard_user = admin dashboard_pwd = admin vhost_http_port = 9000 #subdomain_host = pi.eveneko.com 后台启动\n1 nohup ./frps -c frps.ini\u003e/dev/null 2\u003e\u00261 \u0026 在 /etc/init.d 下新建文件 frps.init\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 #!/bin/bash ### BEGIN INIT INFO # Provides: frp # Required-Start: $local_fs $remote_fs $network $syslog # Required-Stop: $local_fs $remote_fs $network $syslog # Default-Start: 2 3 4 5 # Default-Stop: 0 1 6 # Short-Description: frps service # Description: frps service daemon ### END INIT INFO case \"$1\" in start) echo \"starting frps\" nohup /home/ubuntu/Workspace/frp/frps -c /home/ubuntu/Workspace/frp/frps.ini\u003e/dev/null 2\u003e\u00261 \u0026 ;; stop) echo \"stopping frps\" kill $(ps aux|grep -m 1 '/home/ubuntu/Workspace/frp/frps -c /home/ubuntu/Workspace/frp/frps.ini'|awk '{ print $2}') ;; *) echo \"Usage: service frps start|stop\" exit 1 ;; esac exit 0 开机启动目前用supervisor实现，还可以守护进程。\n客户端\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 [common] server_addr = pi.eveneko.com server_port = 7000 privilege_token = eveneko [ssh] type = tcp local_ip = 127.0.0.1 local_port = 22 remote_port = 2222 [pi-vnc] type = tcp local_ip = 127.0.0.1 local_port = 5900 remote_port = 5901 [pi-jupyter] type = http local_port = 8888 custom_domains = jupyter.pi.eveneko.com #subdomain = jupyter [pi-ariaNg] type = http local_port = 8788 custom_domains = aria2.pi.eveneko.com [pi-aria2] type = tcp local_ip = 127.0.0.1 local_port = 6800 remote_port = 6800 [pi-portainer] type = http local_port = 8988 custom_domains = portainer.pi.eveneko.com [pi-clash] type = http local_port = 8588 custom_domains = clash.pi.eveneko.com [pi-calendar] type = http local_port = 5000 custom_domains = calendar.pi.eveneko.com 后台启动\n1 nohup ./frpc -c frpc.ini\u003e/dev/null 2\u003e\u00261 \u0026 在 /etc/init.d 下新建文件 frpc.init\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 #!/bin/bash ### BEGIN INIT INFO # Provides: frp # Required-Start: $local_fs $remote_fs $network $syslog # Required-Stop: $local_fs $remote_fs $network $syslog # Default-Start: 2 3 4 5 # Default-Stop: 0 1 6 # Short-Description: frpc service # Description: frpc service daemon ### END INIT INFO case \"$1\" in start) echo \"starting frpc\" nohup /home/pi/Workspace/frp/frpc -c /home/pi/Workspace/frp/frpc.ini\u003e/dev/null 2\u003e\u00261 \u0026 ;; stop) echo \"stopping frpc\" kill $(ps aux|grep -m 1 '/home/pi/Workspace/frp/frpc -c /home/pi/Workspace/frp/frpc.ini'|awk '{ print $2}') ;; *) echo \"Usage: service frpc start|stop\" exit 1 ;; esac exit 0 开机启动目前用supervisor实现，还可以守护进程。\nsupervisor 帮助我们守护进程，自动恢复服务\n安装\n1 sudo apt-get install supervisor 配置\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 [program:frpc] directory = /home/pi/Workspace/frp/ ; command = /home/pi/Workspace/frp/frpc -c /home/pi/Workspace/frp/frpc.ini ; root = pi ; stopsignal = INT ; autostart = true ; startsecs = 5 ; autorestart = true ; startretries = 10 ; stopasgroup = true ; killasgroup = true ; redirect_stderr = true ; stdout_logfile_maxbytes = 20MB ; stdout_logfile_backups = 20 ; stdout_logfile = /var/log/frpc.log ; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 [program:jupyterlab] directory = /home/pi/ ; command = python3 -m jupyterlab ; user = pi ; stopsignal = INT ; autostart = true ; startsecs = 10 ; autorestart = true ; startretries = 10 ; stopasgroup = true ; killasgroup = true ; redirect_stderr = true ; stdout_logfile_maxbytes = 20MB ; stdout_logfile_backups = 20 ; stdout_logfile = /var/log/jupyterlab.log ; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 [program:ncovbot] directory = /home/pi/Workspace/BUPT-NCOV-AUTO-REPORT-BOT/ ; command = /home/pi/Workspace/BUPT-NCOV-AUTO-REPORT-BOT/venv/bin/python3 ./main.py ; environment=http_proxy=\"http://localhost:7890\",https_proxy=\"http://localhost:7890\" user = pi ; stopsignal = INT ; autostart = true ; startsecs = 5 ; autorestart = true ; startretries = 10 ; stopasgroup = true ; killasgroup = true ; redirect_stderr = true ; stdout_logfile_maxbytes = 20MB ; stdout_logfile_backups = 20 ; stdout_logfile = /var/log/ncovbot.log ; 注意 supervisor 的环境变量需要\n重新加载配置\n1 sudo supervisorctl reload 查看状态\n1 sudo supervisorctl status 注意user是root到时候，可能会出现一下环境问题\ndocker docker\n1 sudo curl -sSL https://get.docker.com | sh 换源\n1 sudo vim /etc/docker/daemon.json 1 2 3 { \"registry-mirrors\": [\"https://registry.docker-cn.com\"] } docker-compose\nDocker Compose 的安装方式有很多种，但由于 ARM 架构的限制，树莓派上的 Docker Compose 建议使用 pip 安装。\n1 sudo pip3 install -U docker-compose ui\n1 2 3 sudo docker volume create portainer_data sudo docker run -d -p 8988:9000 --name portainer --restart always -v /var/run/docker.sock:/var/run/docker.sock -v portainer_data:/data portainer/ 默认用户admin\nAria2 Aria2 是一款自由、跨平台命令行界面的下载管理器，和 wget 这类下载器不同的是，Aria2 不仅支持 BitTorrent，还能够从各种来源多路检索所请求的文件。包括 HTTP，HTTPS，FTP 和 BitTorrent 协议。\n而且 Raspbain 系统默认已经安装了 Aria2，运行 apt-cache show aria2 即可查看安装信息。\n1 sudo docker run -d --name aria2-ui-pi -p 8788:80 -p 6800:6800 -v /data:/data --restart=always huangzulin/aria2-ui-pi 默认用户/密码 admin/admin\nmysql 为Nextcloud准备\n1 2 3 4 5 6 7 8 docker pull mysql docker run -d -p 3306:3306 -v /mnt/sde/mysql:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=my-secret-pw --name mysql mysql # linux/arm/v7 不支持mysql，需要安装 docker pull hypriot/rpi-mysql docker run --name some-mysql -e MYSQL_ROOT_PASSWORD=my-secret-pw -d -p 12345:3306 hypriot/rpi-mysql Nextcloud Nextcloud是一款开源免费的私有云存储网盘项目，可以让你快速便捷地搭建一套属于自己或团队的云同步网盘，从而实现跨平台跨设备文件同步、共享、版本控制、团队协作等功能。它的客户端覆盖了Windows、Mac、Android、iOS、Linux 等各种平台，也提供了网页端以及 WebDAV接口，所以你几乎可以在各种设备上方便地访问你的云盘。\n1 2 3 sudo docker pull nextcloud docker run -d --restart=always -p 8688:80 -v /mnt/sde/nextcloud:/var/www/html -v /mnt/sde:/var/www/data -link mysql:mysql --name nextcloud nextcloud –link 链接数据库容器，链接使用mysql容器镜像mysql（容器名称）, 不使用则为sqlite数据库 -v 挂载目录，将容器/var/www/html挂载到主机/mnt/sde/nextcloud下面，html为服务路径，稍后会修改/mnt/sde/nextcloud/config/config.php的data，修改data的目录\ndocker-compose.yml\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 version: '2' services: mysql: image: ibex/debian-mysql-server-5.7 restart: always volumes: - db:/var/lib/mysql environment: - MYSQL_ROOT_PASSWORD=root - MYSQL_PASSWORD=\u003cpassword\u003e - MYSQL_DATABASE=nextcloud - MYSQL_USER=nextcloud container_name: mysql nextcloud: image: arm32v7/nextcloud ports: - 8688:80 links: - mysql volumes: - nextcloud:/var/www/html restart: always container_name: nextcloud volumes: db: nextcloud: 等一块硬盘盒\nsmb 1 docker run -d -p 139:139 -p 445:445 --name samba -v /mnt/sde:/mount --restart=always dperson/samba -u \"root;root\" -s \"root;/mount/;yes;no;yes;all;all;all\" -w \"WORKGROUP\" -g \"force user=root\" -g \"guest account=root\" clash 科学上网，dddd\ndocker-compose.yaml\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 version: '3' services: clash: # ghcr.io/dreamacro/clash # ghcr.io/dreamacro/clash-premium # dreamacro/clash # dreamacro/clash-premium image: dreamacro/clash container_name: clash volumes: - ./config.yaml:/root/.config/clash/config.yaml # - ./ui:/ui # dashboard volume ports: - \"7890:7890\" - \"7891:7891\" - \"9090:9090\" # - \"8080:8080\" # external controller (Restful API) # # TUN # cap_add: # - NET_ADMIN # devices: # - /dev/net/tun restart: unless-stopped #network_mode: \"bridge\" # or \"host\" on Linux clash_web: image: haishanh/yacd restart: always depends_on: - clash ports: - 8588:80 container_name: clash_web 创建 config.yaml后，执行\n1 sudo docker-compose up -d 查看log\n1 sudo docker-compose logs 停止clash\n1 docker-compose stop 测试\n1 curl -x 127.0.0.1:7890 http://www.google.com 设置代理\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 # Define `setproxy` command to enable proxy configuration setproxy() { export http_proxy=\"http://localhost:7890\" export https_proxy=\"http://localhost:7890\" } # Define `unsetproxy` command to disable proxy configuration unsetproxy() { unset http_proxy unset https_proxy } # By default, enable proxy configuration for terminal login setproxy pihole Pi-hole 是一款开源且免费的 DNS 沉洞服务器（DNS sinkhole）\ndocker-compose.yaml\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 version: \"3\" # More info at https://github.com/pi-hole/docker-pi-hole/ and https://docs.pi-hole.net/ services: pihole: container_name: pihole image: pihole/pihole:latest ports: - \"53:53/tcp\" - \"53:53/udp\" #- \"67:67/udp\" # Only required if you are using Pi-hole as your DHCP server - \"8488:80/tcp\" environment: TZ: 'America/Chicago' # WEBPASSWORD: 'set a secure password here or it will be random' # Volumes store your data between container upgrades volumes: - './etc-pihole:/etc/pihole' - './etc-dnsmasq.d:/etc/dnsmasq.d' # https://github.com/pi-hole/docker-pi-hole#note-on-capabilities cap_add: - NET_ADMIN # Recommended but not required (DHCP needs NET_ADMIN) restart: unless-stopped web\nhttp://ip.hole/\nhttp://:/admin\nad host\nhttps://github.com/otobtc/ADhosts https://github.com/privacy-protection-tools/anti-AD 国内广告屏蔽不够全面 设备有时候不自动更换dns\n","wordCount":"4087","inLanguage":"zh","datePublished":"2022-01-09T19:50:35+08:00","dateModified":"2022-01-09T19:50:35+08:00","author":{"@type":"Person","name":"Eveneko"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://eveneko.com/posts/raspberry-pi-tutorial/"},"publisher":{"@type":"Organization","name":"Neko Nest","logo":{"@type":"ImageObject","url":"https://eveneko.com/images/logo.svg"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://eveneko.com accesskey=h title="Neko Nest (Alt + H)"><img src=https://eveneko.com/images/logo.svg alt aria-label=logo height=35>Neko Nest</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://eveneko.com/search/ title="🔍 搜索"><span>🔍 搜索</span></a></li><li><a href=https://eveneko.com/archives/ title="🕙 时间轴"><span>🕙 时间轴</span></a></li><li><a href=https://eveneko.com/categories/ title="🧩 分类"><span>🧩 分类</span></a></li><li><a href=https://eveneko.com/tags/ title="🏷️ 标签"><span>🏷️ 标签</span></a></li><li><a href=https://eveneko.com/about/ title="🙋🏻‍♂️ 关于"><span>🙋🏻‍♂️ 关于</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://eveneko.com>主页</a>&nbsp;»&nbsp;<a href=https://eveneko.com/posts/>Posts</a></div><h1 class=post-title>Raspberry Pi 指北</h1><div class=post-meta>&lt;span title='2022-01-09 19:50:35 +0800 +0800'>2022-01-09&lt;/span>&amp;nbsp;·&amp;nbsp;9 分钟&amp;nbsp;·&amp;nbsp;4087 字&amp;nbsp;·&amp;nbsp;Eveneko&nbsp;|&nbsp;<a href=https://github.com/Eveneko/Blob-Source/edit/master/content/posts/raspberry-pi-tutorial/index.md rel="noopener noreferrer" target=_blank>Edit on GitHub</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>目录</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#引言>引言</a></li><li><a href=#设备>设备</a><ul><li><a href=#硬件>硬件</a></li><li><a href=#主要接口>主要接口</a></li><li><a href=#gpio-引脚>GPIO 引脚</a></li><li><a href=#散热器>散热器</a></li></ul></li><li><a href=#搭建系统>搭建系统</a><ul><li><a href=#下载镜像>下载镜像</a></li><li><a href=#镜像烧写>镜像烧写</a></li><li><a href=#树莓派访问方式>树莓派访问方式</a></li><li><a href=#树莓派配置>树莓派配置</a></li><li><a href=#树莓派网络与更新配置>树莓派网络与更新配置</a></li><li><a href=#挂载>挂载</a></li><li><a href=#墨水屏>墨水屏</a></li></ul></li><li><a href=#软件>软件</a><ul><li><a href=#统计端口>统计端口</a></li><li><a href=#中文>中文</a></li><li><a href=#python3>python3</a></li><li><a href=#nginx>nginx</a></li><li><a href=#jupyterlab>jupyterlab</a></li><li><a href=#frp内网穿透>frp内网穿透</a></li><li><a href=#supervisor>supervisor</a></li><li><a href=#docker>docker</a></li><li><a href=#aria2>Aria2</a></li><li><a href=#mysql>mysql</a></li><li><a href=#nextcloud>Nextcloud</a></li><li><a href=#smb>smb</a></li><li><a href=#clash>clash</a></li><li><a href=#pihole>pihole</a></li></ul></li></ul></nav></div></details></div><div class=post-content><p><del>女朋友送的礼物，当然要好好折腾折腾</del></p><h2 id=引言>引言<a hidden class=anchor aria-hidden=true href=#引言>#</a></h2><p>树莓派到如今已经发布了4代，性能自然是越来越强了，每一代都分为A、B型，也有比较特殊的型号比如去掉大部分接口很小巧的树莓派Zero、去掉所有接口的树莓派计算型CM（Compute Module）、B型的增强型B+等。其中B型是最常用的，而A、B型区别也只在于尺寸和接口不同，SoC基本都是一致的。</p><h2 id=设备>设备<a hidden class=anchor aria-hidden=true href=#设备>#</a></h2><ul><li>MacBook Pro (14-inch, 2021)</li><li>Raspberry Pi Model B (4GB)</li></ul><h3 id=硬件>硬件<a hidden class=anchor aria-hidden=true href=#硬件>#</a></h3><h3 id=主要接口>主要接口<a hidden class=anchor aria-hidden=true href=#主要接口>#</a></h3><p><img loading=lazy src=https://cdn.jsdelivr.net/gh/Eveneko/Source-Hosting@master/PicX/image.3n1bt9t7f4g0.webp alt=image></p><h3 id=gpio-引脚>GPIO 引脚<a hidden class=anchor aria-hidden=true href=#gpio-引脚>#</a></h3><p><img loading=lazy src=https://cdn.jsdelivr.net/gh/Eveneko/Source-Hosting@master/PicX/image.2lbwis4a50hs.webp alt=image></p><h3 id=散热器>散热器<a hidden class=anchor aria-hidden=true href=#散热器>#</a></h3><p>风扇的接线是接载树莓派最外排是从右往左数第二和第三个引脚上，红色接第二根引脚（+5V），黑色接第三根引脚（GND）。</p><p><img loading=lazy src=https://cdn.jsdelivr.net/gh/Eveneko/Source-Hosting@master/PicX/IMG_2982.3us2vc9oimrk.webp alt=IMG_2982></p><h2 id=搭建系统>搭建系统<a hidden class=anchor aria-hidden=true href=#搭建系统>#</a></h2><p>树莓派开发板没有配置板载 FLASH，它支持 SD 卡启动（或者从U盘启动），所以我们需要下载相应镜像，并将其烧写在 SD 上制作系统盘。</p><p>支持的系统如下：
Raspbian、Arch Linux ARM、Debian Squeeze、Firefox OS、Gentoo Linux、Google Chrome OS、Raspberry Pi Fedora Remix、Slackware ARM、QtonPi、Slackware ARM、WebOS、RISC OS、FreeBSD、NetBSD、Android 4.0(Ice Cream Sandwich)</p><h3 id=下载镜像>下载镜像<a hidden class=anchor aria-hidden=true href=#下载镜像>#</a></h3><p><a href=https://www.raspberrypi.com/software/operating-systems/>https://www.raspberrypi.com/software/operating-systems/</a></p><p>建议 NOOBS 安装。Mac用户直接可以跳过。</p><h3 id=镜像烧写>镜像烧写<a hidden class=anchor aria-hidden=true href=#镜像烧写>#</a></h3><h4 id=准备工作>准备工作<a hidden class=anchor aria-hidden=true href=#准备工作>#</a></h4><ul><li>TF卡（2GB以上）</li><li>读卡器</li><li>Raspberry Pi Imager（Mac烧录工具）</li></ul><p><img loading=lazy src=https://cdn.jsdelivr.net/gh/Eveneko/Source-Hosting@master/PicX/image.3trqvho5oev4.webp alt=image></p><blockquote><p>Tips</p><ol><li>4b没有标准HDMI接口，只有micro HDMI接口</li><li>建议准备一根网线，直连在路由器上，这样方便获得树莓派ip地址</li><li>默认树莓派没有开启ssh，vnc服务，所以在无法连接显示屏的情况下，建议下载已经修改过设置的镜像</li></ol></blockquote><h3 id=树莓派访问方式>树莓派访问方式<a hidden class=anchor aria-hidden=true href=#树莓派访问方式>#</a></h3><ul><li><p>外接 HDMI 或者 AV 显示器，USB 鼠标、键盘</p><ul><li>初次连接使用</li></ul></li><li><p>使用 USB 转 TTL 串口模块通过串口访问树莓派</p><p><img loading=lazy src=https://cdn.jsdelivr.net/gh/Eveneko/Source-Hosting@master/PicX/image.59bsjq7cops0.webp alt=image></p></li><li><p>SSH</p><ul><li>username: pi</li><li>password: raspberry</li></ul></li><li><p>VNC</p></li></ul><blockquote><p>运营商普遍屏蔽了5900这个端口，注意转发</p></blockquote><h3 id=树莓派配置>树莓派配置<a hidden class=anchor aria-hidden=true href=#树莓派配置>#</a></h3><p>经过前面的步骤，树莓派已经可以正常工作了，但在正式开发使用之前，还需要做一些配置。</p><p>树莓派第一次使用的时候需要进行一个简单的配置，在命令行模式下运行以下命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo raspi-config
</span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=https://cdn.jsdelivr.net/gh/Eveneko/Source-Hosting@master/PicX/image.6nl2hiv00zcw.webp alt=image></p><ul><li>System Options<ul><li>Wireless LAN 无线设置</li><li>Password 修改密码</li></ul></li><li>Interface Options<ul><li>SSH 开启SSH</li><li>VNC 开启VNC</li></ul></li><li>Localisation Options<ul><li>Lacale 建议英文</li><li>Timezone 初始为英国，这里改成 Shanghai/Hong Kong</li></ul></li><li>Overclock 超频选项，新手不建议调整</li></ul><h3 id=树莓派网络与更新配置>树莓派网络与更新配置<a hidden class=anchor aria-hidden=true href=#树莓派网络与更新配置>#</a></h3><h4 id=有线网络>有线网络<a hidden class=anchor aria-hidden=true href=#有线网络>#</a></h4><ul><li>自动获取 IP：树莓派默认有线网卡是使能的，只需将网线插入树莓派网卡，即可自动获得 IP(要求在局域网内)。</li><li>手动设定 IP：如果是电脑与树莓派直连，不能自动获得 IP，可以使用：ifconfig eth0 192.168.1.123 设定 ip(下次重启就没了)。</li><li>设置静态 IP：如果担心在同网络情况下 ip 或者不固定，可以讲电脑设置为静态 ip<ul><li>打开文件 <code>/etc/dhcpcd.conf</code></li><li>修改 <code># Example static IP configuration</code> 下面的配置</li></ul></li></ul><h4 id=无线网络>无线网络<a hidden class=anchor aria-hidden=true href=#无线网络>#</a></h4><p>4b带有WiFi模块，所以可以直接跳过。</p><h4 id=更新软件源>更新软件源<a hidden class=anchor aria-hidden=true href=#更新软件源>#</a></h4><p>Linux的软件不像Windows，基本都是需要在线安装的，但是树莓派由于各种原因其默认的软件源在国内速度并不是很理想，所以需要更新一下软件源。</p><ul><li><p>软件更新源</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo vi /etc/apt/sources.list
</span></span></code></pre></td></tr></table></div></div></li><li><p>系统更新源</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo vi /etc/apt/sources.list.d/raspi.list
</span></span></code></pre></td></tr></table></div></div></li></ul><p>这里我们使用 <a href=https://mirrors.tuna.tsinghua.edu.cn/help/raspbian/>清华源</a> ，根据自己机器操作系统的版本修改文件内容。</p><ul><li><p>查看系统版本</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>lsb_release -a
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>No LSB modules are available.
</span></span><span class=line><span class=cl>Distributor ID:	Raspbian
</span></span><span class=line><span class=cl>Description:	Raspbian GNU/Linux 10 (buster)
</span></span><span class=line><span class=cl>Release:	10
</span></span><span class=line><span class=cl>Codename:	buster
</span></span></code></pre></td></tr></table></div></div></li></ul><h3 id=挂载>挂载<a hidden class=anchor aria-hidden=true href=#挂载>#</a></h3><ul><li><p>使用fdisk命令查看设备硬盘情况</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo fdisk -l
</span></span></code></pre></td></tr></table></div></div></li><li><p>使用 <code>df</code> 查看挂载情况</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>df -h
</span></span></code></pre></td></tr></table></div></div></li></ul><h4 id=手动挂载>手动挂载<a hidden class=anchor aria-hidden=true href=#手动挂载>#</a></h4><ul><li><p>在 <code>/mnt</code> 下新建一个目录作为挂载点</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo mkdir /mnt/udisk
</span></span></code></pre></td></tr></table></div></div></li><li><p>挂载</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo mount -o uid=pi,gid=pi /dev/sda1 /mnt/udisk
</span></span></code></pre></td></tr></table></div></div></li><li><p>卸载</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo umount /mnt/1GB_USB_flash
</span></span></code></pre></td></tr></table></div></div></li></ul><blockquote><p>Tips</p><ol><li>sda1 是取决于你的实际情况，a 表示第一个硬盘，1 表示第一个分区。</li><li>FAT 格式 U 盘 mount 本身就能支持，但如果你的 U 盘或移动硬盘使用的是 exFAT 格式，mount 会说不支持。
安装 exfat-fuse 软件之后 mount 就支持了。
<code>sudo apt-get install exfat-fuse</code></li></ol></blockquote><h4 id=开机挂载>开机挂载<a hidden class=anchor aria-hidden=true href=#开机挂载>#</a></h4><ul><li><p>在 <code>/etc/fstab</code> 中新增一行，每次开机都会挂载</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>/dev/sda1 /mnt/udisk vfat rw,defaults 0 0
</span></span></code></pre></td></tr></table></div></div></li></ul><h4 id=热插挂载>热插挂载<a hidden class=anchor aria-hidden=true href=#热插挂载>#</a></h4><p>需要希望想电脑一样，插上自动识别挂载在某一目录下，拔下自动 umount，按以下操作，会自动在 /mnt/udisk 目录下挂载 U 盘。</p><ul><li><p>新建文件</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo vi /etc/udev/rules.d/10-usbstorage.rules
</span></span></code></pre></td></tr></table></div></div></li><li><p>输入</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>KERNEL!=&#34;sd*&#34;, GOTO=&#34;media_by_label_auto_mount_end&#34;  
</span></span><span class=line><span class=cl>SUBSYSTEM!=&#34;block&#34;,GOTO=&#34;media_by_label_auto_mount_end&#34;  
</span></span><span class=line><span class=cl>IMPORT{program}=&#34;/sbin/blkid -o udev -p %N&#34;  
</span></span><span class=line><span class=cl>ENV{ID_FS_TYPE}==&#34;&#34;, GOTO=&#34;media_by_label_auto_mount_end&#34;  
</span></span><span class=line><span class=cl>ENV{ID_FS_LABEL}!=&#34;&#34;, ENV{dir_name}=&#34;%E{ID_FS_LABEL}&#34;  
</span></span><span class=line><span class=cl>ENV{ID_FS_LABEL}==&#34;&#34;, ENV{dir_name}=&#34;Untitled-%k&#34;  
</span></span><span class=line><span class=cl>ACTION==&#34;add&#34;, ENV{mount_options}=&#34;relatime,sync&#34;  
</span></span><span class=line><span class=cl>ACTION==&#34;add&#34;, ENV{ID_FS_TYPE}==&#34;vfat&#34;, ENV{mount_options}=&#34;iocharset=utf8,umaskk  
</span></span><span class=line><span class=cl>=000&#34;  
</span></span><span class=line><span class=cl>ACTION==&#34;add&#34;, ENV{ID_FS_TYPE}==&#34;ntfs&#34;, ENV{mount_options}=&#34;iocharset=utf8,umaskk  
</span></span><span class=line><span class=cl>=000&#34;  
</span></span><span class=line><span class=cl>ACTION==&#34;add&#34;, RUN+=&#34;/bin/mkdir -p /mnt/udisk/&#34;, RUN+=&#34;/bin/mount -o $env{mount__  
</span></span><span class=line><span class=cl>options} /dev/%k /mnt/udisk/&#34;  
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ACTION==&#34;remove&#34;, ENV{dir_name}!=&#34;&#34;, RUN+=&#34;/bin/umount -l /mnt/udisk/}&#34;, RUN+=&#34;//  
</span></span><span class=line><span class=cl>bin/rmdir /mnt/udisk/&#34;  
</span></span><span class=line><span class=cl>LABEL=&#34;media_by_label_auto_mount_end&#34;
</span></span></code></pre></td></tr></table></div></div><blockquote><p>4b上不需要这个功能，默认挂在 <code>/media/pi/&lt;udisk_name></code></p></blockquote></li></ul><h3 id=墨水屏>墨水屏<a hidden class=anchor aria-hidden=true href=#墨水屏>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>== Hardware connection ==
</span></span><span class=line><span class=cl>    EPD    =&gt;    Raspberry Pi
</span></span><span class=line><span class=cl>  * VCC    -&gt;    3.3
</span></span><span class=line><span class=cl>  * GND    -&gt;    GND
</span></span><span class=line><span class=cl>  * DIN    -&gt;    MOSI
</span></span><span class=line><span class=cl>  * CLK    -&gt;    SCLK
</span></span><span class=line><span class=cl>  * CS     -&gt;    24 (Physical, BCM: CE0, 8)
</span></span><span class=line><span class=cl>  * D/C    -&gt;    22 (Physical, BCM: 25)
</span></span><span class=line><span class=cl>  * RES    -&gt;    11 (Physical, BCM: 17)
</span></span><span class=line><span class=cl>  * BUSY   -&gt;    18 (Physical, BCM: 24)
</span></span></code></pre></td></tr></table></div></div><h2 id=软件>软件<a hidden class=anchor aria-hidden=true href=#软件>#</a></h2><h3 id=统计端口>统计端口<a hidden class=anchor aria-hidden=true href=#统计端口>#</a></h3><table><thead><tr><th style=text-align:center>application</th><th style=text-align:center>local port</th><th style=text-align:center>url</th></tr></thead><tbody><tr><td style=text-align:center>smb</td><td style=text-align:center>139,445</td><td style=text-align:center></td></tr><tr><td style=text-align:center>mysql</td><td style=text-align:center>3306</td><td style=text-align:center></td></tr><tr><td style=text-align:center>calendar</td><td style=text-align:center>5000</td><td style=text-align:center>calendar.pi.eveneko.com:9000</td></tr><tr><td style=text-align:center>vnc</td><td style=text-align:center>5900</td><td style=text-align:center>pi.eveneko.com:5901</td></tr><tr><td style=text-align:center>pihole_web</td><td style=text-align:center>8488</td><td style=text-align:center></td></tr><tr><td style=text-align:center>clash_web</td><td style=text-align:center>8588</td><td style=text-align:center>clash.pi.eveneko.com:9000</td></tr><tr><td style=text-align:center>clash</td><td style=text-align:center>7890,9090</td><td style=text-align:center></td></tr><tr><td style=text-align:center>nextcloud</td><td style=text-align:center>8688</td><td style=text-align:center></td></tr><tr><td style=text-align:center>aria2</td><td style=text-align:center>6800</td><td style=text-align:center></td></tr><tr><td style=text-align:center>ariaNg</td><td style=text-align:center>8788</td><td style=text-align:center>aria2.pi.eveneko.com:9000</td></tr><tr><td style=text-align:center>frp dashboard</td><td style=text-align:center>7500</td><td style=text-align:center>pi.eveneko.com:7500</td></tr><tr><td style=text-align:center>jupyter</td><td style=text-align:center>8888</td><td style=text-align:center>jupyter.pi.eveneko.com:9000</td></tr><tr><td style=text-align:center>portainer</td><td style=text-align:center>8988</td><td style=text-align:center>portainer.pi.eveneko.com:9000</td></tr></tbody></table><h3 id=中文>中文<a hidden class=anchor aria-hidden=true href=#中文>#</a></h3><ul><li><p>安装中文字库</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo apt-get install ttf-wqy-zenhei
</span></span></code></pre></td></tr></table></div></div></li><li><p>安装中文输入法</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo apt-get install fcitx fcitx-googlepinyin fcitx-module-cloudpinyin fcitx-sunpinyin
</span></span></code></pre></td></tr></table></div></div></li></ul><h3 id=python3>python3<a hidden class=anchor aria-hidden=true href=#python3>#</a></h3><ul><li><p>默认使用python3</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo rm /usr/bin/python
</span></span><span class=line><span class=cl>sudo ln -s /usr/bin/python3.7 /usr/bin/python
</span></span></code></pre></td></tr></table></div></div></li><li><p>换源</p><ul><li><p>临时使用</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>pip install -i https://pypi.tuna.tsinghua.edu.cn/simple some-package
</span></span></code></pre></td></tr></table></div></div></li><li><p>设为默认</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>pip3 config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simple
</span></span><span class=line><span class=cl>pip3 install pip -U
</span></span></code></pre></td></tr></table></div></div></li></ul></li></ul><h3 id=nginx>nginx<a hidden class=anchor aria-hidden=true href=#nginx>#</a></h3><ul><li><p>安装</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo apt-get install nginx
</span></span></code></pre></td></tr></table></div></div></li><li><p>其他命令</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=c1># 启动 nginx</span>
</span></span><span class=line><span class=cl><span class=n>systemctl</span> <span class=n>start</span> <span class=n>nginx</span>
</span></span><span class=line><span class=cl><span class=c1># 停止</span>
</span></span><span class=line><span class=cl><span class=n>systemctl</span> <span class=n>stop</span> <span class=n>nginx</span>
</span></span><span class=line><span class=cl><span class=c1># 加载配置文件</span>
</span></span><span class=line><span class=cl><span class=n>systemctl</span> <span class=n>reload</span> <span class=n>nginx</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>启动</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>systemctl enable nginx
</span></span></code></pre></td></tr></table></div></div></li></ul><h3 id=jupyterlab>jupyterlab<a hidden class=anchor aria-hidden=true href=#jupyterlab>#</a></h3><ul><li><p>安装</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>pip3 install jupyter
</span></span></code></pre></td></tr></table></div></div></li><li><p>配置</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>python3 -m jupyter notebook --generate-config
</span></span></code></pre></td></tr></table></div></div><p>修改以下内容</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>c.NotebookApp.allow_origin = &#39;*&#39;
</span></span><span class=line><span class=cl>c.NotebookApp.ip = &#39;0.0.0.0&#39;
</span></span><span class=line><span class=cl>c.NotebookApp.open_browser = False
</span></span><span class=line><span class=cl>c.NotebookApp.port = 8888
</span></span><span class=line><span class=cl>c.NotebookApp.notebook_dir = &#39;&lt;/home/pi&gt;&#39;
</span></span><span class=line><span class=cl>c.NotebookApp.allow_root = True
</span></span><span class=line><span class=cl>c.NotebookApp.allow_remote_access = True
</span></span><span class=line><span class=cl>c.NotebookApp.token = &#39;&#39;
</span></span></code></pre></td></tr></table></div></div></li><li><p>开机自启动</p><p>在 <code>/etc/init.d</code> 下新建文件 <code>jupyter.init</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/bin/bash 
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=c1>### BEGIN INIT INFO</span>
</span></span><span class=line><span class=cl><span class=c1># Provides:          jupyter</span>
</span></span><span class=line><span class=cl><span class=c1># Required-Start:    $local_fs $remote_fs $network $syslog</span>
</span></span><span class=line><span class=cl><span class=c1># Required-Stop:     $local_fs $remote_fs $network $syslog</span>
</span></span><span class=line><span class=cl><span class=c1># Default-Start:     2 3 4 5</span>
</span></span><span class=line><span class=cl><span class=c1># Default-Stop:      0 1 6</span>
</span></span><span class=line><span class=cl><span class=c1># Short-Description: jupyter service</span>
</span></span><span class=line><span class=cl><span class=c1># Description:       jupyter service daemon</span>
</span></span><span class=line><span class=cl><span class=c1>### END INIT INFO </span>
</span></span><span class=line><span class=cl><span class=k>case</span> <span class=s2>&#34;</span><span class=nv>$1</span><span class=s2>&#34;</span> in
</span></span><span class=line><span class=cl>    start<span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>echo</span> <span class=s2>&#34;starting jupyterlab&#34;</span>
</span></span><span class=line><span class=cl>        su pi -c <span class=s2>&#34;nohub python3 -m jupyterlab &gt; /dev/null 2&gt;&amp;1 &amp;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>;;</span>
</span></span><span class=line><span class=cl>    stop<span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>echo</span> <span class=s2>&#34;stopping jupyterlab&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nb>kill</span> <span class=k>$(</span>ps aux<span class=p>|</span>grep -m <span class=m>1</span> <span class=s1>&#39;python3 -m jupyterlab&#39;</span><span class=p>|</span>awk <span class=s1>&#39;{ print $2}&#39;</span><span class=k>)</span>
</span></span><span class=line><span class=cl>        <span class=p>;;</span>
</span></span><span class=line><span class=cl>    *<span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>echo</span> <span class=s2>&#34;Usage: service jupyterlab start|stop&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nb>exit</span> <span class=m>1</span>
</span></span><span class=line><span class=cl>        <span class=p>;;</span>
</span></span><span class=line><span class=cl><span class=k>esac</span>
</span></span><span class=line><span class=cl><span class=nb>exit</span> <span class=m>0</span>
</span></span></code></pre></td></tr></table></div></div><p>添加权限</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo chmod +x /etc/init.d/jupyter.init
</span></span></code></pre></td></tr></table></div></div><p>设置开机启动</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo update-rc.d jupyter.init defaults
</span></span></code></pre></td></tr></table></div></div><p>重启</p><p><code>rcconf</code> 查看启动项</p><blockquote><p>开机启动目前用supervisor实现，还可以守护进程。</p></blockquote></li></ul><h3 id=frp内网穿透>frp内网穿透<a hidden class=anchor aria-hidden=true href=#frp内网穿透>#</a></h3><p>frp 是一个高性能的反向代理应用，可以帮助您轻松地进行内网穿透，对外网提供服务，支持 tcp, http, https 等协议类型，并且 web 服务支持根据域名进行路由转发。</p><p>在 <a href=https://github.com/fatedier/frp/releases>frp releases</a> 下载对应版本的frp</p><p>下载后，对应修改 <code>frps.ini</code></p><ul><li><p>服务端</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[common]
</span></span><span class=line><span class=cl>bbind_port = 7000
</span></span><span class=line><span class=cl>privilege_token = eveneko
</span></span><span class=line><span class=cl>max_pool_count = 5
</span></span><span class=line><span class=cl>dashboard_port = 7500
</span></span><span class=line><span class=cl>dashboard_user = admin
</span></span><span class=line><span class=cl>dashboard_pwd = admin
</span></span><span class=line><span class=cl>vhost_http_port = 9000
</span></span><span class=line><span class=cl>#subdomain_host = pi.eveneko.com
</span></span></code></pre></td></tr></table></div></div><p>后台启动</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>nohup ./frps -c frps.ini&gt;/dev/null 2&gt;&amp;1 &amp;
</span></span></code></pre></td></tr></table></div></div><p>在 <code>/etc/init.d</code> 下新建文件 <code>frps.init</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/bin/bash 
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=c1>### BEGIN INIT INFO</span>
</span></span><span class=line><span class=cl><span class=c1># Provides:          frp</span>
</span></span><span class=line><span class=cl><span class=c1># Required-Start:    $local_fs $remote_fs $network $syslog</span>
</span></span><span class=line><span class=cl><span class=c1># Required-Stop:     $local_fs $remote_fs $network $syslog</span>
</span></span><span class=line><span class=cl><span class=c1># Default-Start:     2 3 4 5</span>
</span></span><span class=line><span class=cl><span class=c1># Default-Stop:      0 1 6</span>
</span></span><span class=line><span class=cl><span class=c1># Short-Description: frps service</span>
</span></span><span class=line><span class=cl><span class=c1># Description:       frps service daemon</span>
</span></span><span class=line><span class=cl><span class=c1>### END INIT INFO </span>
</span></span><span class=line><span class=cl><span class=k>case</span> <span class=s2>&#34;</span><span class=nv>$1</span><span class=s2>&#34;</span> in
</span></span><span class=line><span class=cl>    start<span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>echo</span> <span class=s2>&#34;starting frps&#34;</span>
</span></span><span class=line><span class=cl>        nohup /home/ubuntu/Workspace/frp/frps -c /home/ubuntu/Workspace/frp/frps.ini&gt;/dev/null 2&gt;<span class=p>&amp;</span><span class=m>1</span> <span class=p>&amp;</span>
</span></span><span class=line><span class=cl>        <span class=p>;;</span>
</span></span><span class=line><span class=cl>    stop<span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>echo</span> <span class=s2>&#34;stopping frps&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nb>kill</span> <span class=k>$(</span>ps aux<span class=p>|</span>grep -m <span class=m>1</span> <span class=s1>&#39;/home/ubuntu/Workspace/frp/frps -c /home/ubuntu/Workspace/frp/frps.ini&#39;</span><span class=p>|</span>awk <span class=s1>&#39;{ print $2}&#39;</span><span class=k>)</span>
</span></span><span class=line><span class=cl>        <span class=p>;;</span>
</span></span><span class=line><span class=cl>    *<span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>echo</span> <span class=s2>&#34;Usage: service frps start|stop&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nb>exit</span> <span class=m>1</span>
</span></span><span class=line><span class=cl>        <span class=p>;;</span>
</span></span><span class=line><span class=cl><span class=k>esac</span>
</span></span><span class=line><span class=cl><span class=nb>exit</span> <span class=m>0</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p>开机启动目前用supervisor实现，还可以守护进程。</p></blockquote></li><li><p>客户端</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[common]
</span></span><span class=line><span class=cl>server_addr = pi.eveneko.com
</span></span><span class=line><span class=cl>server_port = 7000
</span></span><span class=line><span class=cl>privilege_token = eveneko
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[ssh]
</span></span><span class=line><span class=cl>type = tcp
</span></span><span class=line><span class=cl>local_ip = 127.0.0.1
</span></span><span class=line><span class=cl>local_port = 22
</span></span><span class=line><span class=cl>remote_port = 2222
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[pi-vnc]
</span></span><span class=line><span class=cl>type = tcp
</span></span><span class=line><span class=cl>local_ip = 127.0.0.1
</span></span><span class=line><span class=cl>local_port = 5900
</span></span><span class=line><span class=cl>remote_port = 5901
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[pi-jupyter]
</span></span><span class=line><span class=cl>type = http
</span></span><span class=line><span class=cl>local_port = 8888
</span></span><span class=line><span class=cl>custom_domains = jupyter.pi.eveneko.com
</span></span><span class=line><span class=cl>#subdomain = jupyter
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[pi-ariaNg]
</span></span><span class=line><span class=cl>type = http
</span></span><span class=line><span class=cl>local_port = 8788
</span></span><span class=line><span class=cl>custom_domains = aria2.pi.eveneko.com
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[pi-aria2]
</span></span><span class=line><span class=cl>type = tcp
</span></span><span class=line><span class=cl>local_ip = 127.0.0.1
</span></span><span class=line><span class=cl>local_port = 6800
</span></span><span class=line><span class=cl>remote_port = 6800
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[pi-portainer]
</span></span><span class=line><span class=cl>type = http
</span></span><span class=line><span class=cl>local_port = 8988
</span></span><span class=line><span class=cl>custom_domains = portainer.pi.eveneko.com
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[pi-clash]
</span></span><span class=line><span class=cl>type = http
</span></span><span class=line><span class=cl>local_port = 8588
</span></span><span class=line><span class=cl>custom_domains = clash.pi.eveneko.com
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[pi-calendar]
</span></span><span class=line><span class=cl>type = http
</span></span><span class=line><span class=cl>local_port = 5000
</span></span><span class=line><span class=cl>custom_domains = calendar.pi.eveneko.com
</span></span></code></pre></td></tr></table></div></div><p>后台启动</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>nohup ./frpc -c frpc.ini&gt;/dev/null 2&gt;&amp;1 &amp;
</span></span></code></pre></td></tr></table></div></div><p>在 <code>/etc/init.d</code> 下新建文件 <code>frpc.init</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/bin/bash 
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=c1>### BEGIN INIT INFO</span>
</span></span><span class=line><span class=cl><span class=c1># Provides:          frp</span>
</span></span><span class=line><span class=cl><span class=c1># Required-Start:    $local_fs $remote_fs $network $syslog</span>
</span></span><span class=line><span class=cl><span class=c1># Required-Stop:     $local_fs $remote_fs $network $syslog</span>
</span></span><span class=line><span class=cl><span class=c1># Default-Start:     2 3 4 5</span>
</span></span><span class=line><span class=cl><span class=c1># Default-Stop:      0 1 6</span>
</span></span><span class=line><span class=cl><span class=c1># Short-Description: frpc service</span>
</span></span><span class=line><span class=cl><span class=c1># Description:       frpc service daemon</span>
</span></span><span class=line><span class=cl><span class=c1>### END INIT INFO </span>
</span></span><span class=line><span class=cl><span class=k>case</span> <span class=s2>&#34;</span><span class=nv>$1</span><span class=s2>&#34;</span> in
</span></span><span class=line><span class=cl>    start<span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>echo</span> <span class=s2>&#34;starting frpc&#34;</span>
</span></span><span class=line><span class=cl>        nohup /home/pi/Workspace/frp/frpc -c /home/pi/Workspace/frp/frpc.ini&gt;/dev/null 2&gt;<span class=p>&amp;</span><span class=m>1</span> <span class=p>&amp;</span>
</span></span><span class=line><span class=cl>        <span class=p>;;</span>
</span></span><span class=line><span class=cl>    stop<span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>echo</span> <span class=s2>&#34;stopping frpc&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nb>kill</span> <span class=k>$(</span>ps aux<span class=p>|</span>grep -m <span class=m>1</span> <span class=s1>&#39;/home/pi/Workspace/frp/frpc -c /home/pi/Workspace/frp/frpc.ini&#39;</span><span class=p>|</span>awk <span class=s1>&#39;{ print $2}&#39;</span><span class=k>)</span>
</span></span><span class=line><span class=cl>        <span class=p>;;</span>
</span></span><span class=line><span class=cl>    *<span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>echo</span> <span class=s2>&#34;Usage: service frpc start|stop&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nb>exit</span> <span class=m>1</span>
</span></span><span class=line><span class=cl>        <span class=p>;;</span>
</span></span><span class=line><span class=cl><span class=k>esac</span>
</span></span><span class=line><span class=cl><span class=nb>exit</span> <span class=m>0</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p>开机启动目前用supervisor实现，还可以守护进程。</p></blockquote></li></ul><h3 id=supervisor>supervisor<a hidden class=anchor aria-hidden=true href=#supervisor>#</a></h3><p>帮助我们守护进程，自动恢复服务</p><ul><li><p>安装</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo apt-get install supervisor
</span></span></code></pre></td></tr></table></div></div></li><li><p>配置</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=p>[</span><span class=n>program</span><span class=p>:</span><span class=n>frpc</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>directory</span> <span class=o>=</span> <span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>pi</span><span class=o>/</span><span class=n>Workspace</span><span class=o>/</span><span class=n>frp</span><span class=o>/</span> <span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>command</span> <span class=o>=</span> <span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>pi</span><span class=o>/</span><span class=n>Workspace</span><span class=o>/</span><span class=n>frp</span><span class=o>/</span><span class=n>frpc</span> <span class=o>-</span><span class=n>c</span> <span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>pi</span><span class=o>/</span><span class=n>Workspace</span><span class=o>/</span><span class=n>frp</span><span class=o>/</span><span class=n>frpc</span><span class=o>.</span><span class=n>ini</span> <span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>root</span> <span class=o>=</span> <span class=n>pi</span> <span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>stopsignal</span> <span class=o>=</span> <span class=n>INT</span> <span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>autostart</span> <span class=o>=</span> <span class=bp>true</span> <span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>startsecs</span> <span class=o>=</span> <span class=mi>5</span> <span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>autorestart</span> <span class=o>=</span> <span class=bp>true</span> <span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>startretries</span> <span class=o>=</span> <span class=mi>10</span> <span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>stopasgroup</span> <span class=o>=</span> <span class=bp>true</span> <span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>killasgroup</span> <span class=o>=</span> <span class=bp>true</span> <span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>redirect_stderr</span> <span class=o>=</span> <span class=bp>true</span> <span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>stdout_logfile_maxbytes</span> <span class=o>=</span> <span class=mi>20</span><span class=n>MB</span> <span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>stdout_logfile_backups</span> <span class=o>=</span> <span class=mi>20</span> <span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>stdout_logfile</span> <span class=o>=</span> <span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=nb>log</span><span class=o>/</span><span class=n>frpc</span><span class=o>.</span><span class=n>log</span> <span class=p>;</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=p>[</span><span class=n>program</span><span class=p>:</span><span class=n>jupyterlab</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>directory</span> <span class=o>=</span> <span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>pi</span><span class=o>/</span> <span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>command</span> <span class=o>=</span> <span class=n>python3</span> <span class=o>-</span><span class=n>m</span> <span class=n>jupyterlab</span> <span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>user</span> <span class=o>=</span> <span class=n>pi</span> <span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>stopsignal</span> <span class=o>=</span> <span class=n>INT</span> <span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>autostart</span> <span class=o>=</span> <span class=bp>true</span> <span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>startsecs</span> <span class=o>=</span> <span class=mi>10</span> <span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>autorestart</span> <span class=o>=</span> <span class=bp>true</span> <span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>startretries</span> <span class=o>=</span> <span class=mi>10</span> <span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>stopasgroup</span> <span class=o>=</span> <span class=bp>true</span> <span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>killasgroup</span> <span class=o>=</span> <span class=bp>true</span> <span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>redirect_stderr</span> <span class=o>=</span> <span class=bp>true</span> <span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>stdout_logfile_maxbytes</span> <span class=o>=</span> <span class=mi>20</span><span class=n>MB</span> <span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>stdout_logfile_backups</span> <span class=o>=</span> <span class=mi>20</span> <span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>stdout_logfile</span> <span class=o>=</span> <span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=nb>log</span><span class=o>/</span><span class=n>jupyterlab</span><span class=o>.</span><span class=n>log</span> <span class=p>;</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=p>[</span><span class=n>program</span><span class=p>:</span><span class=n>ncovbot</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>directory</span> <span class=o>=</span> <span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>pi</span><span class=o>/</span><span class=n>Workspace</span><span class=o>/</span><span class=n>BUPT</span><span class=o>-</span><span class=n>NCOV</span><span class=o>-</span><span class=n>AUTO</span><span class=o>-</span><span class=n>REPORT</span><span class=o>-</span><span class=n>BOT</span><span class=o>/</span> <span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>command</span> <span class=o>=</span> <span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>pi</span><span class=o>/</span><span class=n>Workspace</span><span class=o>/</span><span class=n>BUPT</span><span class=o>-</span><span class=n>NCOV</span><span class=o>-</span><span class=n>AUTO</span><span class=o>-</span><span class=n>REPORT</span><span class=o>-</span><span class=n>BOT</span><span class=o>/</span><span class=n>venv</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=n>python3</span> <span class=o>./</span><span class=n>main</span><span class=o>.</span><span class=n>py</span> <span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>environment</span><span class=o>=</span><span class=n>http_proxy</span><span class=o>=</span><span class=s2>&#34;http://localhost:7890&#34;</span><span class=p>,</span><span class=n>https_proxy</span><span class=o>=</span><span class=s2>&#34;http://localhost:7890&#34;</span>
</span></span><span class=line><span class=cl><span class=n>user</span> <span class=o>=</span> <span class=n>pi</span> <span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>stopsignal</span> <span class=o>=</span> <span class=n>INT</span> <span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>autostart</span> <span class=o>=</span> <span class=bp>true</span> <span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>startsecs</span> <span class=o>=</span> <span class=mi>5</span> <span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>autorestart</span> <span class=o>=</span> <span class=bp>true</span> <span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>startretries</span> <span class=o>=</span> <span class=mi>10</span> <span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>stopasgroup</span> <span class=o>=</span> <span class=bp>true</span> <span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>killasgroup</span> <span class=o>=</span> <span class=bp>true</span> <span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>redirect_stderr</span> <span class=o>=</span> <span class=bp>true</span> <span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>stdout_logfile_maxbytes</span> <span class=o>=</span> <span class=mi>20</span><span class=n>MB</span> <span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>stdout_logfile_backups</span> <span class=o>=</span> <span class=mi>20</span> <span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>stdout_logfile</span> <span class=o>=</span> <span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=nb>log</span><span class=o>/</span><span class=n>ncovbot</span><span class=o>.</span><span class=n>log</span> <span class=p>;</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p>注意 supervisor 的环境变量需要</p></blockquote></li><li><p>重新加载配置</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>sudo</span> <span class=n>supervisorctl</span> <span class=n>reload</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>查看状态</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo supervisorctl status
</span></span></code></pre></td></tr></table></div></div><blockquote><p>注意user是root到时候，可能会出现一下环境问题</p></blockquote></li></ul><h3 id=docker>docker<a hidden class=anchor aria-hidden=true href=#docker>#</a></h3><ul><li><p>docker</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo curl -sSL https://get.docker.com | sh
</span></span></code></pre></td></tr></table></div></div></li><li><p>换源</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo vim /etc/docker/daemon.json
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>{
</span></span><span class=line><span class=cl>&#34;registry-mirrors&#34;: [&#34;https://registry.docker-cn.com&#34;]
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div></li><li><p>docker-compose</p><p>Docker Compose 的安装方式有很多种，但由于 ARM 架构的限制，树莓派上的 Docker Compose 建议使用 pip 安装。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo pip3 install -U docker-compose
</span></span></code></pre></td></tr></table></div></div></li><li><p>ui</p></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>sudo</span> <span class=n>docker</span> <span class=n>volume</span> <span class=n>create</span> <span class=n>portainer_data</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sudo</span> <span class=n>docker</span> <span class=n>run</span> <span class=o>-</span><span class=n>d</span> <span class=o>-</span><span class=n>p</span> <span class=mi>8988</span><span class=p>:</span><span class=mi>9000</span> <span class=o>--</span><span class=n>name</span> <span class=n>portainer</span> <span class=o>--</span><span class=n>restart</span> <span class=n>always</span> <span class=o>-</span><span class=n>v</span> <span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>run</span><span class=o>/</span><span class=n>docker</span><span class=o>.</span><span class=n>sock</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>run</span><span class=o>/</span><span class=n>docker</span><span class=o>.</span><span class=n>sock</span> <span class=o>-</span><span class=n>v</span> <span class=n>portainer_data</span><span class=p>:</span><span class=o>/</span><span class=n>data</span> <span class=n>portainer</span><span class=o>/</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p>默认用户admin</p></blockquote><h3 id=aria2>Aria2<a hidden class=anchor aria-hidden=true href=#aria2>#</a></h3><p>Aria2 是一款自由、跨平台命令行界面的下载管理器，和 wget 这类下载器不同的是，Aria2 不仅支持 BitTorrent，还能够从各种来源多路检索所请求的文件。包括 HTTP，HTTPS，FTP 和 BitTorrent 协议。</p><p>而且 Raspbain 系统默认已经安装了 Aria2，运行 <code>apt-cache show aria2</code> 即可查看安装信息。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo docker run -d --name aria2-ui-pi -p 8788:80 -p 6800:6800 -v /data:/data --restart=always huangzulin/aria2-ui-pi
</span></span></code></pre></td></tr></table></div></div><blockquote><p>默认用户/密码 admin/admin</p></blockquote><h3 id=mysql>mysql<a hidden class=anchor aria-hidden=true href=#mysql>#</a></h3><p>为Nextcloud准备</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>docker</span> <span class=n>pull</span> <span class=n>mysql</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>docker</span> <span class=n>run</span> <span class=o>-</span><span class=n>d</span> <span class=o>-</span><span class=n>p</span> <span class=mi>3306</span><span class=p>:</span><span class=mi>3306</span> <span class=o>-</span><span class=n>v</span> <span class=o>/</span><span class=n>mnt</span><span class=o>/</span><span class=n>sde</span><span class=o>/</span><span class=n>mysql</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>mysql</span> <span class=o>-</span><span class=n>e</span> <span class=n>MYSQL_ROOT_PASSWORD</span><span class=o>=</span><span class=n>my</span><span class=o>-</span><span class=n>secret</span><span class=o>-</span><span class=n>pw</span> <span class=o>--</span><span class=n>name</span> <span class=n>mysql</span> <span class=n>mysql</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># linux/arm/v7 不支持mysql，需要安装</span>
</span></span><span class=line><span class=cl><span class=n>docker</span> <span class=n>pull</span> <span class=n>hypriot</span><span class=o>/</span><span class=n>rpi</span><span class=o>-</span><span class=n>mysql</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>docker</span> <span class=n>run</span> <span class=o>--</span><span class=n>name</span> <span class=n>some</span><span class=o>-</span><span class=n>mysql</span> <span class=o>-</span><span class=n>e</span> <span class=n>MYSQL_ROOT_PASSWORD</span><span class=o>=</span><span class=n>my</span><span class=o>-</span><span class=n>secret</span><span class=o>-</span><span class=n>pw</span> <span class=o>-</span><span class=n>d</span> <span class=o>-</span><span class=n>p</span> <span class=mi>12345</span><span class=p>:</span><span class=mi>3306</span> <span class=n>hypriot</span><span class=o>/</span><span class=n>rpi</span><span class=o>-</span><span class=n>mysql</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=nextcloud>Nextcloud<a hidden class=anchor aria-hidden=true href=#nextcloud>#</a></h3><p>Nextcloud是一款开源免费的私有云存储网盘项目，可以让你快速便捷地搭建一套属于自己或团队的云同步网盘，从而实现跨平台跨设备文件同步、共享、版本控制、团队协作等功能。它的客户端覆盖了Windows、Mac、Android、iOS、Linux 等各种平台，也提供了网页端以及 WebDAV接口，所以你几乎可以在各种设备上方便地访问你的云盘。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>sudo</span> <span class=n>docker</span> <span class=n>pull</span> <span class=n>nextcloud</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>docker</span> <span class=n>run</span> <span class=o>-</span><span class=n>d</span> <span class=o>--</span><span class=n>restart</span><span class=o>=</span><span class=n>always</span> <span class=o>-</span><span class=n>p</span> <span class=mi>8688</span><span class=p>:</span><span class=mi>80</span> <span class=o>-</span><span class=n>v</span> <span class=o>/</span><span class=n>mnt</span><span class=o>/</span><span class=n>sde</span><span class=o>/</span><span class=n>nextcloud</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>www</span><span class=o>/</span><span class=n>html</span> <span class=o>-</span><span class=n>v</span> <span class=o>/</span><span class=n>mnt</span><span class=o>/</span><span class=n>sde</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>www</span><span class=o>/</span><span class=n>data</span> <span class=o>-</span><span class=n>link</span> <span class=n>mysql</span><span class=p>:</span><span class=n>mysql</span> <span class=o>--</span><span class=n>name</span> <span class=n>nextcloud</span> <span class=n>nextcloud</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p>&ndash;link 链接数据库容器，链接使用mysql容器镜像mysql（容器名称）, 不使用则为sqlite数据库
-v 挂载目录，将容器<code>/var/www/html</code>挂载到主机<code>/mnt/sde/nextcloud</code>下面，html为服务路径，稍后会修改<code>/mnt/sde/nextcloud/config/config.php</code>的data，修改data的目录</p></blockquote><p><code>docker-compose.yml</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>version</span><span class=p>:</span> <span class=s1>&#39;2&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>services</span><span class=p>:</span>
</span></span><span class=line><span class=cl>  <span class=n>mysql</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>image</span><span class=p>:</span> <span class=n>ibex</span><span class=o>/</span><span class=n>debian</span><span class=o>-</span><span class=n>mysql</span><span class=o>-</span><span class=n>server</span><span class=o>-</span><span class=mf>5.7</span>
</span></span><span class=line><span class=cl>    <span class=n>restart</span><span class=p>:</span> <span class=n>always</span>
</span></span><span class=line><span class=cl>    <span class=n>volumes</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=o>-</span> <span class=n>db</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>mysql</span>
</span></span><span class=line><span class=cl>    <span class=n>environment</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=o>-</span> <span class=n>MYSQL_ROOT_PASSWORD</span><span class=o>=</span><span class=n>root</span>
</span></span><span class=line><span class=cl>      <span class=o>-</span> <span class=n>MYSQL_PASSWORD</span><span class=o>=&lt;</span><span class=n>password</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=o>-</span> <span class=n>MYSQL_DATABASE</span><span class=o>=</span><span class=n>nextcloud</span>
</span></span><span class=line><span class=cl>      <span class=o>-</span> <span class=n>MYSQL_USER</span><span class=o>=</span><span class=n>nextcloud</span>
</span></span><span class=line><span class=cl>    <span class=n>container_name</span><span class=p>:</span> <span class=n>mysql</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>nextcloud</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>image</span><span class=p>:</span> <span class=n>arm32v7</span><span class=o>/</span><span class=n>nextcloud</span>
</span></span><span class=line><span class=cl>    <span class=n>ports</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=o>-</span> <span class=mi>8688</span><span class=p>:</span><span class=mi>80</span>
</span></span><span class=line><span class=cl>    <span class=n>links</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=o>-</span> <span class=n>mysql</span>
</span></span><span class=line><span class=cl>    <span class=n>volumes</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=o>-</span> <span class=n>nextcloud</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>www</span><span class=o>/</span><span class=n>html</span>
</span></span><span class=line><span class=cl>    <span class=n>restart</span><span class=p>:</span> <span class=n>always</span>
</span></span><span class=line><span class=cl>    <span class=n>container_name</span><span class=p>:</span> <span class=n>nextcloud</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>volumes</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>db</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>nextcloud</span><span class=p>:</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p>等一块硬盘盒</p></blockquote><h3 id=smb>smb<a hidden class=anchor aria-hidden=true href=#smb>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>docker run -d -p 139:139 -p 445:445 --name samba -v /mnt/sde:/mount --restart=always dperson/samba -u &#34;root;root&#34; -s &#34;root;/mount/;yes;no;yes;all;all;all&#34; -w &#34;WORKGROUP&#34; -g &#34;force user=root&#34; -g &#34;guest account=root&#34;
</span></span></code></pre></td></tr></table></div></div><h3 id=clash>clash<a hidden class=anchor aria-hidden=true href=#clash>#</a></h3><p>科学上网，dddd</p><ul><li><p><code>docker-compose.yaml</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>version: &#39;3&#39;
</span></span><span class=line><span class=cl>services:
</span></span><span class=line><span class=cl>clash:
</span></span><span class=line><span class=cl>    # ghcr.io/dreamacro/clash
</span></span><span class=line><span class=cl>    # ghcr.io/dreamacro/clash-premium
</span></span><span class=line><span class=cl>    # dreamacro/clash
</span></span><span class=line><span class=cl>    # dreamacro/clash-premium
</span></span><span class=line><span class=cl>    image: dreamacro/clash
</span></span><span class=line><span class=cl>    container_name: clash
</span></span><span class=line><span class=cl>    volumes:
</span></span><span class=line><span class=cl>    - ./config.yaml:/root/.config/clash/config.yaml
</span></span><span class=line><span class=cl>    # - ./ui:/ui # dashboard volume
</span></span><span class=line><span class=cl>    ports:
</span></span><span class=line><span class=cl>    - &#34;7890:7890&#34;
</span></span><span class=line><span class=cl>    - &#34;7891:7891&#34;
</span></span><span class=line><span class=cl>    - &#34;9090:9090&#34;
</span></span><span class=line><span class=cl>    # - &#34;8080:8080&#34; # external controller (Restful API)
</span></span><span class=line><span class=cl>    # # TUN
</span></span><span class=line><span class=cl>    # cap_add:
</span></span><span class=line><span class=cl>    #   - NET_ADMIN
</span></span><span class=line><span class=cl>    # devices:
</span></span><span class=line><span class=cl>    #   - /dev/net/tun
</span></span><span class=line><span class=cl>    restart: unless-stopped
</span></span><span class=line><span class=cl>#network_mode: &#34;bridge&#34; # or &#34;host&#34; on Linux
</span></span><span class=line><span class=cl>clash_web:
</span></span><span class=line><span class=cl>    image: haishanh/yacd
</span></span><span class=line><span class=cl>    restart: always
</span></span><span class=line><span class=cl>    depends_on:
</span></span><span class=line><span class=cl>        - clash
</span></span><span class=line><span class=cl>    ports:
</span></span><span class=line><span class=cl>        - 8588:80
</span></span><span class=line><span class=cl>    container_name: clash_web
</span></span></code></pre></td></tr></table></div></div></li><li><p>创建 <code>config.yaml</code>后，执行</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo docker-compose up -d
</span></span></code></pre></td></tr></table></div></div></li><li><p>查看log</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo docker-compose logs
</span></span></code></pre></td></tr></table></div></div></li><li><p>停止clash</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>docker-compose stop
</span></span></code></pre></td></tr></table></div></div></li><li><p>测试</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>curl -x 127.0.0.1:7890 http://www.google.com
</span></span></code></pre></td></tr></table></div></div></li><li><p>设置代理</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=c1># Define `setproxy` command to enable proxy configuration
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nf>setproxy</span><span class=p>()</span><span class=w> </span><span class=err>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>export</span><span class=w> </span><span class=n>http_proxy</span><span class=o>=</span><span class=s2>&#34;http://localhost:7890&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>export</span><span class=w> </span><span class=n>https_proxy</span><span class=o>=</span><span class=s2>&#34;http://localhost:7890&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=err>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1># Define `unsetproxy` command to disable proxy configuration
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nf>unsetproxy</span><span class=p>()</span><span class=w> </span><span class=err>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>unset</span><span class=w> </span><span class=n>http_proxy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>unset</span><span class=w> </span><span class=n>https_proxy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=err>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1># By default, enable proxy configuration for terminal login
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>setproxy</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li></ul><h3 id=pihole>pihole<a hidden class=anchor aria-hidden=true href=#pihole>#</a></h3><p>Pi-hole 是一款开源且免费的 DNS 沉洞服务器（DNS sinkhole）</p><ul><li><p><code>docker-compose.yaml</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>version: &#34;3&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># More info at https://github.com/pi-hole/docker-pi-hole/ and https://docs.pi-hole.net/
</span></span><span class=line><span class=cl>services:
</span></span><span class=line><span class=cl>pihole:
</span></span><span class=line><span class=cl>    container_name: pihole
</span></span><span class=line><span class=cl>    image: pihole/pihole:latest
</span></span><span class=line><span class=cl>    ports:
</span></span><span class=line><span class=cl>    - &#34;53:53/tcp&#34;
</span></span><span class=line><span class=cl>    - &#34;53:53/udp&#34;
</span></span><span class=line><span class=cl>    #- &#34;67:67/udp&#34; # Only required if you are using Pi-hole as your DHCP server
</span></span><span class=line><span class=cl>    - &#34;8488:80/tcp&#34;
</span></span><span class=line><span class=cl>    environment:
</span></span><span class=line><span class=cl>    TZ: &#39;America/Chicago&#39;
</span></span><span class=line><span class=cl>    # WEBPASSWORD: &#39;set a secure password here or it will be random&#39;
</span></span><span class=line><span class=cl>    # Volumes store your data between container upgrades
</span></span><span class=line><span class=cl>    volumes:
</span></span><span class=line><span class=cl>    - &#39;./etc-pihole:/etc/pihole&#39;
</span></span><span class=line><span class=cl>    - &#39;./etc-dnsmasq.d:/etc/dnsmasq.d&#39;    
</span></span><span class=line><span class=cl>    #   https://github.com/pi-hole/docker-pi-hole#note-on-capabilities
</span></span><span class=line><span class=cl>    cap_add:
</span></span><span class=line><span class=cl>    - NET_ADMIN # Recommended but not required (DHCP needs NET_ADMIN)      
</span></span><span class=line><span class=cl>    restart: unless-stopped
</span></span></code></pre></td></tr></table></div></div></li><li><p>web</p><ul><li><p><a href=http://ip.hole/>http://ip.hole/</a></p></li><li><p>http://&lt;ip>:&lt;port>/admin</p><p><img loading=lazy src=https://cdn.jsdelivr.net/gh/Eveneko/Source-Hosting@master/PicX/image.6wze390yq9ds.webp alt=image></p></li></ul></li><li><p>ad host</p><ul><li><a href=https://github.com/otobtc/ADhosts>https://github.com/otobtc/ADhosts</a></li><li><a href=https://github.com/privacy-protection-tools/anti-AD>https://github.com/privacy-protection-tools/anti-AD</a></li></ul></li></ul><blockquote><p>国内广告屏蔽不够全面
设备有时候不自动更换dns</p></blockquote></div><footer class=post-footer><ul class=post-tags><li><a href=https://eveneko.com/tags/raspberry-pi/>Raspberry Pi</a></li></ul><nav class=paginav><a class=prev href=https://eveneko.com/posts/vue-tutorial/><span class=title>« 上一页</span><br><span>Vue 入门</span>
</a><a class=next href=https://eveneko.com/posts/klee-tutorial/><span class=title>下一页 »</span><br><span>Klee 入门</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://eveneko.com>Neko Nest</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="复制";function s(){t.innerHTML="已复制！",setTimeout(()=>{t.innerHTML="复制"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>